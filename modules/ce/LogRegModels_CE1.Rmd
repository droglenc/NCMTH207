---
title: Exercise
subtitle: Logistic Regression Models and Predictions
author: Derek H. Ogle
layout: page
css: "/css/modules.css"
output:
  html_document:
    fig_height: 4
    fig_width: 4
    self_contained: false
---

```{r echo=FALSE, eval=FALSE, warning=FALSE}
# Renders an appropriate HTML file for the webpage
setwd("C:/aaaWork/Web/GitHub/NCMTH207/modules/CE/")
source("../../rhelpers/rhelpers.R")
modHTML("LogRegModels_CE1")
```

```{r echo=FALSE, results='hide', message=FALSE, warning=FALSE}
library(NCStats)
library(ggplot2)
source("../../rhelpers/knitr_setup.R")
```

<div class="alert alert-warning">
  <strong>Note</strong> Your answers to the questions below should follow the <a href="../resources/hwformat" target="_blank">expectations for homework found here</a>. Due date is on the <a href="../../resources/Dates-Current" target="_blank">Dates page.</a>
</div>

----

# Marketability of Cucumbers
In [this previous exercise](LogRegFoundations_CE1.html#marketability-of-cucumbers) you used these logistic regression results -- logit(p)=6.430-0.330DOS -- for the Levantino cultivar of cucumber to answer questions about cucumber marketability. Continue with this information to answer the questions below.

1. Interpret the slope.
1. Interpret the exponentiated slope.
1. Predict the days of storage where the probability that the cucumber is marketable is at least 0.90.
1. Predict the days of storage where the probability that the cucumber is marketable first drops below 0.10.

&nbsp;


# Bat Subspecies
Researchers measured (among other things) the canine tooth height (cm) from two subspecies of [Hoary bats](https://en.wikipedia.org/wiki/Hoary_bat) (*Lasiurus cinereus cinereus* and *Lasiurus cinereus semotus*) found in Hawaii. Their primary question was to determine if canine tooth height (hereafter, just tooth height) differed between subspecies and, more importantly to them, could tooth height be used to predict the subspecies of bat. The parameter estimates of the logistic regression model used to predict subspecies (note that *cinereus* was considered a "success") from canine tooth height (mm) is shown below. The fitted logistic regression is also shown in the figure below.

```{r echo=FALSE, message=FALSE}
bat <- read.csv("https://raw.githubusercontent.com/droglenc/NCData/master/Batmorph.csv") %>%
  mutate(canine=canine*10,
         subsp01=ifelse(subsp=="cinereus",1,0))
glm.bat <- glm(subsp01~canine,data=bat,family="binomial")
#boot.bat <- car::Boot(glm.bat)
cfs.bat <- cbind(Ests=coef(glm.bat),confint(glm.bat,type="perc"))
cfs.bat %>%
  knitr::kable(booktabs=TRUE,digits=c(3,3,3)) %>%
  kableExtra::kable_classic(full_width=FALSE,html_font="Cambria")
```
```{r echo=FALSE, warning=FALSE, message=FALSE, fig.align='center'}
ggplot(data=bat,mapping=aes(x=canine,y=subsp01)) +
  geom_point(alpha=0.25) +
  scale_y_continuous(name="Probability of 'cinereus'",
                     expand=expansion(mult=0.02)) +
  scale_x_continuous(name="Canine Tooth Height (mm)",
                     expand=expansion(mult=0.02)) +
  geom_smooth(method="glm",method.args=list(family="binomial"),
              se=FALSE,size=1,color="black") +
  theme_NCStats()
```

Use this information to answer the questions below. *Show your work.*

1. What is the equation of the best-fit logistic regression line? Replace parameters with their estimated values and define all other symbols.
1. Interpret the slope. Use the confidence interval.
1. Interpret the exponentiated (i.e., back-transformed) slope. Use the confidence interval.
1. Predict the log odds of being a *cinereus* if the canine tooth height is 3.
1. Predict the odds of being a *cinereus* if the canine tooth height is 3. Write a sentence about what this value means.
1. Predict the probability of being a *cinereus* if the canine tooth height is 3. Write a sentence about what this value means.
1. Predict the log odds of being a *cinereus* if the canine tooth height is 4 but only using your previous log odds prediction and the estimated value of the slope.
1. Predict the odds of being a *cinereus* if the canine tooth height is 4 but only using your previous odds prediction and the estimated value of the exponentiated slope.
1. What is the canine tooth height where it is "50-50" that the bat is *cinereus* or *semotus*?
1. What is the canine tooth height where you are "very sure" (95% likely) that the bat is a *cinereus*?
1. What is the canine tooth height where you are "very sure" (95% likely) that the bat is a *semotus*?
