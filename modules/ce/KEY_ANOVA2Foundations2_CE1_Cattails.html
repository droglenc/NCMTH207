---
layout: page
title: "Exercise Key"
subtitle: "Two-Way ANOVA Analytical Foundations"
author: Derek H. Ogle
css: "/css/modules.css"
---


<hr />
<div class="alert alert-warning">
<strong>Note:</strong>
<ul>
<li>
The key is to construct a table of means similar to what is shown in the R code as <code>mns</code>. Then SS<sub>habitat</sub>, SS<sub>year</sub> and SS<sub>Among</sub> are computed by following the SS<sub>A</sub>, SS<sub>B</sub> and SS<sub>Among</sub> formulae from the reading. The SS<sub>A:B</sub> is then found by subtracting both SS<sub>habitat</sub> and SS<sub>year</sub> from SS<sub>Among</sub>. The SS<sub>Within</sub> is found by subtracting SS<sub>Among</sub> from SS<sub>Total</sub>. All degrees-of-freedom are found by formulae in the reading, noting that a=2, b=2 and m=25. The MS, F (but note that the denominator is always MS<sub>Within</sub>), and p-values are found as usual (but make sure use <code>df1=1</code> for all but the top row).
</li>
<li>
I did this in R just for fun (you did not have to use R except for the p-values).
</li>
</ul>
</div>
<div id="anova-table" class="section level1">
<h1>ANOVA Table</h1>
<ol>
<li>
Completed table shown below. Calculations shown in the R Code and Results appendix.
</li>
</ol>
<table class=" lightable-classic" style="font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:right;">
SS
</th>
<th style="text-align:right;">
MS
</th>
<th style="text-align:right;">
F
</th>
<th style="text-align:right;">
p
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Among
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1510.2
</td>
<td style="text-align:right;">
503.4
</td>
<td style="text-align:right;">
2.582
</td>
<td style="text-align:right;">
0.0579
</td>
</tr>
<tr>
<td style="text-align:left;">
Year
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1361.6
</td>
<td style="text-align:right;">
1361.6
</td>
<td style="text-align:right;">
6.984
</td>
<td style="text-align:right;">
0.0096
</td>
</tr>
<tr>
<td style="text-align:left;">
Habitat
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
114.5
</td>
<td style="text-align:right;">
114.5
</td>
<td style="text-align:right;">
0.587
</td>
<td style="text-align:right;">
0.4454
</td>
</tr>
<tr>
<td style="text-align:left;">
Year:Habitat
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
34.1
</td>
<td style="text-align:right;">
34.1
</td>
<td style="text-align:right;">
0.175
</td>
<td style="text-align:right;">
0.6768
</td>
</tr>
<tr>
<td style="text-align:left;">
Within
</td>
<td style="text-align:right;">
96
</td>
<td style="text-align:right;">
18717.1
</td>
<td style="text-align:right;">
195.0
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
</tr>
<tr>
<td style="text-align:left;">
Total
</td>
<td style="text-align:right;">
99
</td>
<td style="text-align:right;">
20227.3
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
</tr>
</tbody>
</table>
<ol start="2">
<li>
There is no evidence for an interaction effect (p=0.6768). There is also no evidence for a “habitat” main effect (p=0.4454). However, there is evidence for a “year” main effect (p=0.0096).
</li>
</ol>
<div id="r-code-and-results" class="section level3">
<h3>R Code and Results</h3>
<pre class="r"><code>&gt; library(NCStats)
&gt; 
&gt; tmns &lt;- matrix(c(75.45,83.98,74.46,80.70),byrow=FALSE,nrow=2)
&gt; mns &lt;- addmargins(tmns,FUN=mean,quiet=TRUE)
&gt; colnames(mns) &lt;- c(&quot;far&quot;,&quot;near&quot;,&quot;year&quot;)
&gt; rownames(mns) &lt;- c(&quot;2015&quot;,&quot;2016&quot;,&quot;habitat&quot;)
&gt; mns &lt;- round(mns,2)
&gt; mns</code></pre>
<pre><code>          far  near  year
2015    75.45 74.46 74.96
2016    83.98 80.70 82.34
habitat 79.72 77.58 78.65</code></pre>
<pre class="r"><code>&gt; a &lt;- b &lt;- 2
&gt; m &lt;- 25
&gt; ssyear &lt;- a*m*sum((mns[1:2,3]-mns[3,3])^2)
&gt; sshab &lt;- b*m*sum((mns[3,1:2]-mns[3,3])^2)
&gt; ssamong &lt;- m*sum((mns[1:2,1:2]-mns[3,3])^2)
&gt; ssint &lt;- ssamong-sshab-ssyear
&gt; sstotal &lt;- 20227.3
&gt; sswithin &lt;- sstotal-ssamong
&gt; dfamong &lt;- a*b-1
&gt; dfyear &lt;- a-1
&gt; dfhab &lt;- b-1
&gt; dfint &lt;- dfamong-dfhab-dfyear
&gt; dftotal &lt;- a*b*m-1
&gt; dfwithin &lt;- dftotal-dfamong
&gt; ss &lt;- c(ssamong,ssyear,sshab,ssint,sswithin)
&gt; df &lt;- c(dfamong,dfyear,dfhab,dfint,dfwithin)
&gt; ms &lt;- ss/df
&gt; F &lt;- ms[-length(ms)]/ms[length(ms)]
&gt; distrib(F[1],df1=df[1],df2=df[5],distrib=&quot;f&quot;,lower.tail=FALSE)</code></pre>
<pre class="r"><code>&gt; distrib(F[2],df1=df[2],df2=df[5],distrib=&quot;f&quot;,lower.tail=FALSE)</code></pre>
<pre class="r"><code>&gt; distrib(F[3],df1=df[3],df2=df[5],distrib=&quot;f&quot;,lower.tail=FALSE)</code></pre>
<pre class="r"><code>&gt; distrib(F[4],df1=df[4],df2=df[5],distrib=&quot;f&quot;,lower.tail=FALSE)</code></pre>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
