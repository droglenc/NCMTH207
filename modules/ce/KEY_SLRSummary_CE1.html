---
layout: page
title: "Exercise Key"
subtitle: "SLR Summary"
author: Derek H. Ogle
css: "/css/modules.css"
---


<hr />
<div class="alert alert-warning">
<strong>Note:</strong>
<ul>
<li>
There are no “groups” in simple linear regression; thus, you do not assess “within-” and “among-group” independence here.
</li>
<li>
Use the ANOVA table p-value rather than the summary table slope p-value to assess the relationship as this will generalize to the next module.
</li>
<li>
When describing the relationship, use the confidence interval for the slope. Don’t just use the slope.
</li>
<li>
When back-transforming the slope to describe the relationship on the original scale, note that “a change in log(x) of 1” should be back-transformed to “a change in x of e<sup>1</sup>” which is where the 2.718 below came from. Also, note that the back-transformed slope indicates a “multiplicative” change such that the value is Y is multiplied by the back-transformed slope rather than added to.
<li>
The predictions should use prediction intervals as the original authors were interested in predicting the weight of an individual bear.
</li>
<li>
Note that r<sup>2</sup> should be interpreted on the transformed scale … so how much variability in log weight is explained by knowing log length. The r<sup>2</sup> is not relevant on the original scale because homoscedasticity means that the variability explained will not be the same everywhere on the line.</sup>
</ol>
</ul>
</div>
<hr />
<div id="black-bear-weight" class="section level1">
<h1>Black Bear Weight</h1>
<p>Measuring the live body weight of large-bodied animals can be impractical when equipment needed to weigh individuals is inadequate or unavailable. Thus, the objective of this analysis is to determine if body weight can be predicted from body length for non-cub bears (i.e., older than one year of age). The specific hypotheses for this analysis are:</p>
<p>H<sub>0</sub>: “no relationship between weight and length of non-cub black bears”</p>
<p>H<sub>A</sub>: “is a relationship between weight and length of non-cub black bears”</p>
<p>A total of 274 bears were examined for this study. There is not nearly enough information in the background to fully address the independence assumption, but it is unlikely that the weight of any one bear will have much of an impact on any other bear, let alone have an impact on all other bears. Thus, the independence assumption is adequately met.</p>
<p>The un-transformed data are clearly non-linear and heteroscedastic (see first residual plot below); thus a transformation should be considered. Through a process of trial-and-error, and realizing that weight-length data follows a power function relationship for most organisms, both weight and length were log-transformed. With this transformation the data were largely linear and homoscedastic (see second residual plot below). In addition, the residuals were normal (Anderson-Darling test p=0.3160) and absent of significant outliers (outlier test p=0.2164). Thus, the analysis will continue with a log-log transformation.</p>
<p>There is a significant relationship between log weight and log length of the black bears (ANOVA p&lt;0.00005). In fact, 77.6% of the variability in log weight is explained by log length. The scatterplot with the best-fit line superimposed shown below illustrates the strength of the relationship.</p>
<p>The mean log weight of a bear increases between 2.664 and 3.030 for each unit increase in log body length of the bears. More importantly the mean weight is multiplied by a value between 14.361 and 20.693 for each 2.718 unit increase in length of the bear.</p>
<p>As an example, the weight for a bear with a body length of 130 cm is between 31.5 and 68.3 kg.</p>
<p>These results indicated a fairly strong relationship between weight and length that can be used to predict weight from length, though the precision of this estimate is fairly poor.</p>
<div id="r-code-and-results." class="section level3">
<h3>R Code and Results.</h3>
<pre class="r"><code>bb &lt;- read.csv(&quot;https://raw.githubusercontent.com/droglenc/NCData/master/BlackBears.csv&quot;)
bb &lt;- filter(bb,age&gt;1)
n &lt;- nrow(bb)
lm.bb &lt;- lm(weight~length,data=bb)
assumptionCheck(lm.bb)</code></pre>
<p><img src="KEY_SLRSummary_CE1_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<pre class="r"><code>assumptionCheck(lm.bb,lambday=0,lambdax=0)</code></pre>
<p><img src="KEY_SLRSummary_CE1_files/figure-html/unnamed-chunk-4-2.png" width="672" /></p>
<pre class="r"><code>bb$loglength &lt;- log(bb$length)
bb$logweight &lt;- log(bb$weight)
lm.bbt &lt;- lm(logweight~loglength,data=bb)
anova(lm.bbt)</code></pre>
<pre><code>Analysis of Variance Table

Response: logweight
           Df Sum Sq Mean Sq F value    Pr(&gt;F)
loglength   1 35.853  35.853  941.89 &lt; 2.2e-16
Residuals 272 10.354   0.038                  </code></pre>
<pre class="r"><code>rSquared(lm.bbt)</code></pre>
<pre><code>[1] 0.7759273</code></pre>
<pre class="r"><code>cfs.bbt &lt;- cbind(Est=coef(lm.bbt),confint(lm.bbt))  ## log-log scale
btcfs.bbt &lt;- exp(cfs.bbt) ## back-transformed to original scale
lens &lt;- c(130,160,190)
nd &lt;- data.frame(loglength=log(lens))
( p.logw &lt;- predict(lm.bbt,newdata=nd,interval=&quot;prediction&quot;) )  ## Log scale</code></pre>
<pre><code>       fit      lwr      upr
1 3.837944 3.451493 4.224395
2 4.429122 4.044314 4.813930
3 4.918403 4.532133 5.304673</code></pre>
<pre class="r"><code>cbind(obs=1:3,length=lens,exp(p.logw)) ## Back-transformed</code></pre>
<pre><code>  obs length       fit      lwr       upr
1   1    130  46.42991 31.54746  68.33312
2   2    160  83.85774 57.07199 123.21490
3   3    190 136.78402 92.95667 201.27515</code></pre>
<pre class="r"><code>ggplot(data=bb,mapping=aes(x=loglength,y=logweight)) +  
  geom_point(pch=21,color=&quot;black&quot;,fill=&quot;lightgray&quot;) +  
  labs(x=&quot;log Length&quot;,y=&quot;log Weight&quot;) +  
  theme_NCStats() +  
  geom_smooth(method=&quot;lm&quot;)</code></pre>
<pre><code>`geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="KEY_SLRSummary_CE1_files/figure-html/unnamed-chunk-5-1.png" width="336" /></p>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
