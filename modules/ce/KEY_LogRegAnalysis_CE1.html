---
layout: page
title: "Exercise Key"
subtitle: "Logistic Regression Analysis"
author: Derek H. Ogle
css: "/css/modules.css"
---


<div class="alert alert-warning">
<ul>
<li>
Note that your confidence interval values may be slightly different than mine because there is an inherent randomization that occurs with bootstrapping. They should not be very different.
</li>
</ul>
</div>
<div id="ruffe-feeding" class="section level1">
<h1>Ruffe Feeding</h1>
<ol>
<li>There is a significant relationship between whether or not the Ruffe consumed a <em>Daphnia</em> and the length of the Ruffe (LRT p&lt;0.00005).</li>
<li>The slope says that as the length of the Ruffe increases by one mm then the log odds of having consumed a <em>Daphnia</em> increases between 1.016 and 1.879.</li>
<li>The exponentiated slope says that as the length of the Ruffe increases by one mm then the odds of having consumed a <em>Daphnia</em> is between 2.761 and 6.544 times greater.</li>
<li>The probability that a 6-mm Ruffe will have consumed a <em>Daphnia</em> is between 0.014 and 0.109. Thus, only between 1.4% and 10.9% of 6-mm Ruffe are likely to have consumed a <em>Daphnia</em>.</li>
<li>The odds that a 6-mm Ruffe will have consumed a <em>Daphnia</em> is 0.058. Thus, it is 17.115 times more likely that a 6-mm Ruffe has NOT consumed a <em>Daphnia</em> than it is that is HAS consumed a <em>Daphnia</em>.</li>
<li>The length where 50% of Ruffe have consumed a <em>Daphnia</em> is between 7.727 and 8.574.</li>
<li>The length where 90% of Ruffe have consumed a <em>Daphnia</em> is between 9.183 and 10.547.</li>
<li>The best-fit logistic regression line is shown below.</li>
</ol>
<div id="r-code-and-results" class="section level3">
<h3>R Code and Results</h3>
<pre class="r"><code>&gt; predProb &lt;- function(x,alpha,beta) exp(alpha+beta*x)/(1+exp(alpha+beta*x))
&gt; predX &lt;- function(p,alpha,beta) (log(p/(1-p))-alpha)/beta
&gt; Ruffe &lt;- read.csv(&quot;https://raw.githubusercontent.com/droglenc/NCData/master/RuffeLarvalDiet.csv&quot;)
&gt; Ruffe &lt;- filter(Ruffe,loc==&quot;Allouez&quot;)
&gt; Ruffe$daph01 &lt;- ifelse(Ruffe$o.daph==&quot;Y&quot;,1,0)
&gt; glm.Ruffe &lt;- glm(daph01~len,data=Ruffe,family=binomial)
&gt; anova(glm.Ruffe,test=&quot;LRT&quot;)</code></pre>
<pre><code>Analysis of Deviance Table

Model: binomial, link: logit

Response: daph01

Terms added sequentially (first to last)

     Df Deviance Resid. Df Resid. Dev  Pr(&gt;Chi)
NULL                   163    218.467          
len   1   130.81       162     87.659 &lt; 2.2e-16</code></pre>
<pre class="r"><code>&gt; boot.Ruffe &lt;- car::Boot(glm.Ruffe)
&gt; cbind(Est=coef(glm.Ruffe),confint(boot.Ruffe,type=&quot;perc&quot;))</code></pre>
<pre><code>                   Est      2.5 %    97.5 %
(Intercept) -10.711628 -15.485570 -8.319108
len           1.311943   1.020951  1.897401</code></pre>
<pre class="r"><code>&gt; nd &lt;- data.frame(len=6)
&gt; ( lodds6 &lt;- predict(glm.Ruffe,newdata=nd) )</code></pre>
<pre><code>       1 
-2.83997 </code></pre>
<pre class="r"><code>&gt; exp(lodds6)</code></pre>
<pre><code>         1 
0.05842739 </code></pre>
<pre class="r"><code>&gt; ( prob6 &lt;- predict(glm.Ruffe,newdata=nd,type=&quot;response&quot;) )</code></pre>
<pre><code>         1 
0.05520208 </code></pre>
<pre class="r"><code>&gt; prob6.boot &lt;- predProb(6,boot.Ruffe$t[,1],boot.Ruffe$t[,2])
&gt; ( prob6.ci &lt;- quantile(prob6.boot,probs=c(0.025,0.975),type=1) )</code></pre>
<pre><code>      2.5%      97.5% 
0.01380019 0.10900300 </code></pre>
<pre class="r"><code>&gt; x50.boot &lt;- predX(0.5,boot.Ruffe$t[,1],boot.Ruffe$t[,2])
&gt; ( x50.ci &lt;- quantile(x50.boot,probs=c(0.025,0.975),type=1) )</code></pre>
<pre><code>    2.5%    97.5% 
7.768726 8.582608 </code></pre>
<pre class="r"><code>&gt; x90.boot &lt;- predX(0.9,boot.Ruffe$t[,1],boot.Ruffe$t[,2])
&gt; ( x90.ci &lt;- quantile(x90.boot,probs=c(0.025,0.975),type=1) )</code></pre>
<pre><code>     2.5%     97.5% 
 9.159108 10.536225 </code></pre>
<pre class="r"><code>&gt; ggplot(data=Ruffe,mapping=aes(x=len,y=daph01)) +
    geom_point(alpha=0.1) +
    geom_smooth(method=&quot;glm&quot;,method.args=list(family=binomial)) +
    labs(x=&quot;Total Length (mm)&quot;,y=&quot;Probability of Consuming a Daphnia&quot;) +
    theme_NCStats()</code></pre>
<p><img src="KEY_LogRegAnalysis_CE1_files/figure-html/unnamed-chunk-4-1.png" width="336" /></p>
<p>Â </p>
<!----
# X-Rated Movies



1. There is a significant relationship between whether or not the respondent had watched an x-rated movie in the last year and their age (LRT p<0.00005).
1. The slope says that as the age of the respondent increases by one year then the log odds of having watched an x-rated movie in the last year decreases between -0.047 and -0.043.
1. The exponentiated slope says that as the age of the respondent increases by one year then the odds of having watched an x-rated movie in the last year decreases between 0.955 and 0.958 times. In other words, the odds of having watched an x-rated movie in the last year decline between 4.2 and 4.5% for each increase of one year in age.
1. The odds of a 50-years-old having watched an x-rated movie in the last year is 0.202. Thus, the probability that 50-year old watched an x-rated movie in the last year is 0.202 times more likely than not having watched an x-rated movie in the last year.
1. The probability that a 50-years-old will have watched an x-rated movie in the last year is between 0.163 and 0.173.
1. The age where 10% or fewer of respondents are likely to have watch an x-rated movie in the last year is between 62.1 and 64.6.
1. The age where 25% or more of respondents are likely to have watch an x-rated movie in the last year is between 38.0 and 39.3.
1. The best-fit logistic regression line is shown below.


### R Code and Results

```r
> ggplot(data=xxx,mapping=aes(x=age,y=seen01)) +
    geom_point(alpha=0.01) +
    geom_smooth(method="glm",method.args=list(family=binomial)) +
    labs(x="Age of Respondent",y="Prob. of Seeing XXX Movie in Last Year") +
    theme_NCStats()
```

<img src="KEY_LogRegAnalysis_CE1_files/figure-html/unnamed-chunk-6-1.png" width="336" />


# Moose Calf Production


```r
> aov.p.m <- kPvalue(anova(glm.m,test="LRT")$"Pr(>Chi)"[2],latex=FALSE)
> cfs.m <- cbind(Est=coef(glm.m),confint(boot.m,type="perc"))
> odds10 <- exp(lodds10)
```

1. There is a significant relationship between whether or not the female had at least one calf and the age of the female (LRT p=0.0002).
1. The slope says that as the age of the moose increases by one year then the log odds of having at least one calf decreases between -0.204 and -0.056.
1. The exponentiated slope says that as the age of the moose increases by one year then the odds of having at least one calf decreases between 0.816 and 0.946 times. In other words, the odds of having at least one decline between 5.4 and 5.4% for each increase of one year in age.
1. The log odds of a 10-years-old female moose having at least one calf is 0.797.
1. The odds of a 10-years-old female moose having at least one calf is 2.220. Thus, the probability that 10-year old female moose will have at least one calf is 2.2 times more likely than not having a calf.
1. The probability that a 10-years-old female moose will have at least one calf is between 0.623 and 0.756.
1. The where 75% or fewer of female moose have at least one calf is between 5.922 and 10.390.
1. The best-fit logistic regression line is shown below.

### R Code and Results

```r
> predProb <- function(x,alpha,beta) exp(alpha+beta*x)/(1+exp(alpha+beta*x))
> predX <- function(p,alpha,beta) (log(p/(1-p))-alpha)/beta
> m <- readxl::read_excel("../data/10_3996_032013-jfwm-028_s1.xls")
> m$calf01 <- ifelse(m$"Calf production status"=="Yes",1,0)
> glm.m <- glm(calf01~Age,data=m,family=binomial)
> anova(glm.m,test="LRT")
```

```
Analysis of Deviance Table

Model: binomial, link: logit

Response: calf01

Terms added sequentially (first to last)

     Df Deviance Resid. Df Resid. Dev  Pr(>Chi)
NULL                   415     444.58          
Age   1   13.806       414     430.77 0.0002027
```

```r
> boot.m <- car::Boot(glm.m)
> cbind(Est=coef(glm.m),confint(boot.m,type="perc"))
```

```
                   Est      2.5 %      97.5 %
(Intercept)  2.0870940  1.5418706  2.71075413
Age         -0.1289597 -0.2014201 -0.05180606
```

```r
> nd <- data.frame(Age=10)
> ( lodds10 <- predict(glm.m,newdata=nd) )
```

```
        1 
0.7974973 
```

```r
> exp(lodds10)
```

```
       1 
2.219978 
```

```r
> ( prob10 <- predict(glm.m,newdata=nd,type="response") )
```

```
        1 
0.6894389 
```

```r
> prob10.boot <- predProb(10,boot.m$t[,1],boot.m$t[,2])
> ( prob10.ci <- quantile(prob10.boot,probs=c(0.025,0.975),type=1) )
```

```
     2.5%     97.5% 
0.6207189 0.7604561 
```

```r
> x75.boot <- predX(0.75,boot.m$t[,1],boot.m$t[,2])
> ( x75.ci <- quantile(x75.boot,probs=c(0.025,0.975),type=1) )
```

```
     2.5%     97.5% 
 5.749819 10.804528 
```

```r
> ggplot(data=m,mapping=aes(x=Age,y=calf01)) +
    geom_point(alpha=0.01) +
    geom_smooth(method="glm",method.args=list(family=binomial)) +
    labs(x="Age of Female Moose",y="Probability of At Least 1 Calf") +
    theme_NCStats()
```

```
`geom_smooth()` using formula 'y ~ x'
```

<img src="KEY_LogRegAnalysis_CE1_files/figure-html/unnamed-chunk-8-1.png" width="672" />
--->
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
