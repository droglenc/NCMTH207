---
title: "Exercise Key"
subtitle: "One-Way ANOVA Assumptions"
author: Derek H. Ogle
layout: page
css: "/css/modules.css"
output:
  html_document:
    fig_height: 3.5
    fig_width: 3.5
    self_contained: false
---

```{r echo=FALSE, eval=FALSE, warning=FALSE}
## Renders an appropriate HTML file and moves to CE directory
source("modules/ce/aaaKeys/zzz_modHTML_CEKeys.R")
modHTML_CEKeys("KEY_ANOVA1Assumptions_CE1")
```

```{r echo=FALSE, results='hide', message=FALSE, warning=FALSE}
library(NCStats)
source("../../../rhelpers/knitr_setup.R")
```

# Assumptions I
```{r Assumptions1, echo=FALSE}
df1 <- read.csv("http://derekogle.com/NCMTH207/modules/ce/data/ANOVA1Assumptions1.csv")
lm1 <- lm(measure~group,data=df1)
```
```{r echo=FALSE, warning=FALSE}
lev.p1 <- levenesTest(lm1)$"Pr(>F)"[1]
out.p1 <- outlierTest(lm1)$p[[1]]
ad.p1 <- adTest(lm1$residuals)$p.value
```

The variances do not appear to be equal as suggested by the Levene's test p-value (=`r kPvalue(lev.p1,latex=FALSE,include.p=FALSE)`) and the somewhat different sized boxes in the  boxplots below. The residuals appear to be normal according to the Anderson-Darling p-value (=`r kPvalue(ad.p1,latex=FALSE,include.p=FALSE)`) and the histogram below does not look strongly skewed. There is evidence for a significant outlier according to the outlier test p-value (=`r kPvalue(out.p1,latex=FALSE,include.p=FALSE)`) and the distinctly "odd" individual on the right-side of the residual histogram below.

### R Code and Results.
```{r fig.width=7}
<<Assumptions1>>
assumptionCheck(lm1)
```

&nbsp;

# Assumptions I
```{r Assumptions2, echo=FALSE}
df2 <- read.csv("http://derekogle.com/NCMTH207/modules/ce/data/ANOVA1Assumptions2.csv")
lm2 <- lm(measure~group,data=df2)
```
```{r echo=FALSE, warning=FALSE}
lev.p2 <- levenesTest(lm2)$"Pr(>F)"[1]
out.p2 <- outlierTest(lm2)$p[[1]]
ad.p2 <- adTest(lm2$residuals)$p.value
```

The variances do not appear to be equal based on the different sized boxes in the boxplots below. However, the Levene's test p-value (=`r kPvalue(lev.p2,latex=FALSE,include.p=FALSE)`) suggests that the variances are equal. This test is probably improper due to the outliers that are evident.  The residuals appear to be not normal according to the Anderson-Darling p-value (=`r kPvalue(ad.p2,latex=FALSE,include.p=FALSE)`) and the strongly skewed histogram below. There is evidence for a significant outlier according to the outlier test p-value (=`r kPvalue(out.p2,latex=FALSE,include.p=FALSE)`) and by points outside the "whiskers" in the boxplot of residuals.

### R Code and Results.
```{r fig.width=7}
<<Assumptions2>>
assumptionCheck(lm2)
```

# Temperature and Turtle Hatchings

<div class="alert alert-warning">
<ul>
  <li>For the independence assumption, be clear that you have thought through what it means to be independent within or among groups. It is not adequate to just say "the groups are independent." Also note that there is nothing in the data that speaks to independence. Assessing independence is purely a thought process.</li>
</ul>
</div>

```{r echo=FALSE}
d <- read.csv("c:/aaaWork/Web/GitHub/NCMTH207/modules/ce/aaaKeys/turtles.csv")
d$Temperature <- factor(d$Temperature)
lm3 <- lm(Days~Temperature,data=d)
lev.p3 <- levenesTest(lm3)$"Pr(>F)"[1]
out.p3 <- outlierTest(lm3)$p[[1]]
ad.p3 <- adTest(lm3$residuals)$p.value
```

The variances appear to be equal as suggested by the Levene's test p-value (=`r kPvalue(lev.p3,latex=FALSE,include.p=FALSE)`). The boxes in the boxplot appears different sized, so the p-value results could be due to the small sample size. The residuals appear to be normal according to the Anderson-Darling p-value (=`r kPvalue(ad.p3,latex=FALSE,include.p=FALSE)`) and the histogram below does not look strongly skewed. There is no evidence for a significant outlier according to the outlier test p-value (=`r kPvalue(out.p3,latex=FALSE,include.p=FALSE)`). The boxplots of residuals suggest possible outliers though in the 25<sup>o</sup>C and 30<sup>o</sup>C treatments. From this, I conclude that these three assumptions are tentatively met.

The individuals are likely independent. The background noted that the eggs were put into **individual** containers that were then assigned a temperature. There is not information about where the eggs came from but under the assumption that they did not all come from the same or only a few nests then this is likely not a dependency problem. All-in-all this assumption is likely largely met.

### R Code and Results.
```{r eval=FALSE}
d <- read.csv("turtles.csv")
d$Temperature <- factor(d$Temperature)
```
```{r fig.width=7}
lm3 <- lm(Days~Temperature,data=d)
assumptionCheck(lm3)
```

&nbsp;

# Iron and Mining

<div class="alert alert-warning">
<ul>
  <li>For the independence assumption, be clear that you have thought through what it means to be independent within or among groups. It is not adequate to just say "the groups are independent." Also note that there is nothing in the data that speaks to independence. Assessing independence is purely a thought process.</li>
</ul>
</div>

```{r IronMine, echo=FALSE}
im <- read.csv("https://raw.githubusercontent.com/droglenc/NCData/master/AcidMineDrainage.csv")
im$use <- factor(im$use,levels=c("Unmined","Reclaimed","Abandoned"))
```
```{r echo=FALSE}
lm4 <- lm(FE~use,data=im)
lev.p4 <- levenesTest(lm4)$"Pr(>F)"[1]
out.p4 <- outlierTest(lm4)$p[[1]]
ad.p4 <- adTest(lm4$residuals)$p.value
```

There is a clear issue with normality here as shown by the Anderson-Darling p-value (=`r kPvalue(ad.p4,latex=FALSE,include.p=FALSE)`) and the histogram below is strongly skewed. In addition there is a clear outlier to the far right (in the abandoned group) as shown by the outlier test p-value (=`r kPvalue(out.p4,latex=FALSE,include.p=FALSE)`) and the boxplots of residuals. The variances appear to be equal according to the Levene's test p-value (=`r kPvalue(lev.p4,latex=FALSE,include.p=FALSE)`), but this p-value is likely compromised by the normality and outlier issues. The huge outlier also makes the boxplots of residuals largely uselss for examining equal variances. It is clear that there are violations of these three assumptions.

The individuals are likely independent but this is not abundantly clear. The measurements are from 120 **unique** rivers, so there is not multiple measurements on the same river. However, some of the rivers are likely in the same watershed and would likely share some characteristics due to that (e.g., geological, land use, etc.). The data are likely independent enough for our purposes.


### R Code and Results.
```{r fig.width=7}
<<IronMine>>
assumptionCheck(lm4)
```
