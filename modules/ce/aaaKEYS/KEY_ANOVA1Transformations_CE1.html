<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Derek H. Ogle" />


<title>Exercise Key</title>

<script src="KEY_ANOVA1Transformations_CE1_files/header-attrs-2.6/header-attrs.js"></script>
<script src="KEY_ANOVA1Transformations_CE1_files/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="KEY_ANOVA1Transformations_CE1_files/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="KEY_ANOVA1Transformations_CE1_files/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="KEY_ANOVA1Transformations_CE1_files/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="KEY_ANOVA1Transformations_CE1_files/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="KEY_ANOVA1Transformations_CE1_files/navigation-1.1/tabsets.js"></script>
<link href="KEY_ANOVA1Transformations_CE1_files/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="KEY_ANOVA1Transformations_CE1_files/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


<link rel="stylesheet" href="/css/modules.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>



<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Exercise Key</h1>
<h3 class="subtitle">One-Way ANOVA Transformations</h3>
<h4 class="author">Derek H. Ogle</h4>

</div>


<div class="alert alert-warning">
<ul>
<li>
Refer to specific p-values and graphs when demonstrating that the assumptions are met.
</li>
<li>
Use the ANOVA table p-value when testing for a difference in group means.
</li>
<li>
In question 2 be careful to state that it is the mean of the transformed variable that differs (not the mean of the untransformed variable).
</li>
<li>
Use Tukey’s multiple comparison results when identifying specifically which pairs of group means differ.
</li>
<li>
In questions 3-5 you must specifically refer to the mean of the transformed variable.
</li>
<li>
Note that when the square root transformation was used that the group mean could be back-transformed (question 6) but the difference in group means could not (question 7).
</li>
<li>
Note that when the log transformation was used that both the group mean (question 6) and the difference in group means (question 7) could be back-transformed.
</li>
<li>
I find it hard to interpret the back-transformed difference in means (from the log scale) when the ratio is less than 1. Thus, I prefer to flip the ratio and talk about how the second group is that many times larger than the first group.
</li>
</ul>
</div>
<div id="assumptions-i" class="section level1">
<h1>Assumptions I</h1>
<ol style="list-style-type: decimal">
<li>After <strong>square root</strong> transforming, the variances appear to be equal as suggested by the Levene’s test (p=0.2518) and the similar sized boxes in the boxplots below. The residuals appear to be normally distributed according to the Anderson-Darling test (p=0.2174) and the histogram below does not look strongly skewed. There is no evidence for a significant outlier according to the outlier test (p=0.2832).</li>
<li>There appears to be a difference in mean square root of the measurement variable among some of the group means (ANOVA p&lt;0.00005).</li>
<li>It appears that mean square root of the measurement variable differs between all pairs of groups (p&lt;0.00005), except for the “B” and “D” groups (p=0.8013).</li>
<li>The mean square root of the measurement variable for the “A” group is between 8.48 and 11.36.</li>
<li>The mean square root of the measurement variable is betwen 6.439 and 11.794 units less for the “A” group than for the “B” group.</li>
<li>The back-transformed mean of the measurement variable for the “A” group is between 71.97 (=8.48<sup>2</sup>) and 128.94 (=11.36<sup>2</sup>).</li>
<li>The differences in square root transformed values <strong>can not</strong> be back-transformed!</li>
</ol>
<div id="r-code-and-results." class="section level3">
<h3>R Code and Results.</h3>
<pre class="r"><code>&gt; df1 &lt;- read.csv(&quot;http://derekogle.com/NCMTH207/modules/ce/data/ANOVA1Assumptions1.csv&quot;)
&gt; lm1 &lt;- lm(measure~group,data=df1)
&gt; assumptionCheck(lm1,lambday=0.5)</code></pre>
<p><img src="KEY_ANOVA1Transformations_CE1_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<pre class="r"><code>&gt; df1$sqrtmeas &lt;- sqrt(df1$measure)
&gt; lm1t &lt;- lm(sqrtmeas~group,data=df1)
&gt; anova(lm1t)</code></pre>
<pre><code>Analysis of Variance Table

Response: sqrtmeas
          Df Sum Sq Mean Sq F value    Pr(&gt;F)
group      3 3610.9 1203.62  115.82 &lt; 2.2e-16
Residuals 76  789.8   10.39                  </code></pre>
<pre class="r"><code>&gt; mc1t &lt;- emmeans(lm1t,specs=pairwise~group,tran=&quot;sqrt&quot;)</code></pre>
<pre><code>Note: Use &#39;contrast(regrid(object), ...)&#39; to obtain contrasts of back-transformed estimates</code></pre>
<pre class="r"><code>&gt; ( mcsum1t &lt;- summary(mc1t,infer=TRUE) )</code></pre>
<pre><code>$emmeans
 group emmean    SE df lower.CL upper.CL t.ratio p.value
 A       9.92 0.721 76     8.48     11.4 13.761  &lt;.0001 
 B      19.04 0.721 76    17.60     20.5 26.408  &lt;.0001 
 C      28.90 0.721 76    27.46     30.3 40.090  &lt;.0001 
 D      19.96 0.721 76    18.52     21.4 27.690  &lt;.0001 

Results are given on the sqrt (not the response) scale. 
Confidence level used: 0.95 

$contrasts
 contrast estimate   SE df lower.CL upper.CL t.ratio p.value
 A - B      -9.117 1.02 76   -11.79    -6.44  -8.943 &lt;.0001 
 A - C     -18.979 1.02 76   -21.66   -16.30 -18.618 &lt;.0001 
 A - D     -10.041 1.02 76   -12.72    -7.36  -9.849 &lt;.0001 
 B - C      -9.863 1.02 76   -12.54    -7.18  -9.675 &lt;.0001 
 B - D      -0.924 1.02 76    -3.60     1.75  -0.907 0.8013 
 C - D       8.939 1.02 76     6.26    11.62   8.768 &lt;.0001 

Note: contrasts are still on the sqrt scale 
Confidence level used: 0.95 
Conf-level adjustment: tukey method for comparing a family of 4 estimates 
P value adjustment: tukey method for comparing a family of 4 estimates </code></pre>
<pre class="r"><code>&gt; ( mcsum1bt &lt;- summary(mc1t,infer=TRUE,type=&quot;response&quot;) )</code></pre>
<pre><code>$emmeans
 group response   SE df lower.CL upper.CL t.ratio p.value
 A         98.4 14.3 76       72      129 13.761  &lt;.0001 
 B        362.4 27.4 76      310      419 26.408  &lt;.0001 
 C        835.1 41.7 76      754      920 40.090  &lt;.0001 
 D        398.4 28.8 76      343      458 27.690  &lt;.0001 

Confidence level used: 0.95 
Intervals are back-transformed from the sqrt scale 
Tests are performed on the sqrt scale 

$contrasts
 contrast estimate   SE df lower.CL upper.CL t.ratio p.value
 A - B      -9.117 1.02 76   -11.79    -6.44  -8.943 &lt;.0001 
 A - C     -18.979 1.02 76   -21.66   -16.30 -18.618 &lt;.0001 
 A - D     -10.041 1.02 76   -12.72    -7.36  -9.849 &lt;.0001 
 B - C      -9.863 1.02 76   -12.54    -7.18  -9.675 &lt;.0001 
 B - D      -0.924 1.02 76    -3.60     1.75  -0.907 0.8013 
 C - D       8.939 1.02 76     6.26    11.62   8.768 &lt;.0001 

Note: contrasts are still on the sqrt scale 
Confidence level used: 0.95 
Conf-level adjustment: tukey method for comparing a family of 4 estimates 
P value adjustment: tukey method for comparing a family of 4 estimates </code></pre>
<p> </p>
</div>
</div>
<div id="assumptions-ii" class="section level1">
<h1>Assumptions II</h1>
<ol style="list-style-type: decimal">
<li>After <strong>log</strong> transforming, the variances appear to be equal as suggested by the Levene’s test (p=0.7675) and the similar sized boxes in the boxplots below. The residuals appear to be normally distributed according to the Anderson-Darling test (p=0.5422) and the histogram below does not look strongly skewed. There is no evidence for a significant outlier according to the outlier test (p=0.9257).</li>
<li>There appears to be a difference in mean log of the measurement variable among some of the group means (ANOVA p&lt;0.00005).</li>
<li>It appears that mean log of the measurement variable differs between all three groups (p&lt;0.0135).</li>
<li>The mean log of the measurement variable for the “A” group is between 1.81 and 2.56.</li>
<li>The mean log of the measurement variable is between 0.135 and 1.415 units greater for the “A” group than for the “B” group.</li>
<li>The back-transformed mean of the measurement variable for the “A” group is between 6.08 (=e<sup>1.81</sup>) and 12.94 (=e<sup>2.56</sup>).</li>
<li>The back-transformed mean of the measurement variable for the “A” group is between 1.144 and 4.114 TIMES larger than the back-transformed mean for the “B” group.</li>
</ol>
<div id="r-code-and-results.-1" class="section level3">
<h3>R Code and Results.</h3>
<pre class="r"><code>&gt; df2 &lt;- read.csv(&quot;http://derekogle.com/NCMTH207/modules/ce/data/ANOVA1Assumptions2.csv&quot;)
&gt; lm2 &lt;- lm(measure~group,data=df2)
&gt; assumptionCheck(lm2,lambday=0)</code></pre>
<p><img src="KEY_ANOVA1Transformations_CE1_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<pre class="r"><code>&gt; df2$logmeas &lt;- log(df2$measure)
&gt; lm2t &lt;- lm(logmeas~group,data=df2)
&gt; anova(lm2t)</code></pre>
<pre><code>Analysis of Variance Table

Response: logmeas
          Df Sum Sq Mean Sq F value    Pr(&gt;F)
group      2 46.417 23.2085  21.484 2.613e-08
Residuals 87 93.983  1.0803                  </code></pre>
<pre class="r"><code>&gt; mc2t &lt;- emmeans(lm2t,specs=pairwise~group,tran=&quot;log&quot;)
&gt; ( mcsum2t &lt;- summary(mc2t,infer=TRUE) )</code></pre>
<pre><code>$emmeans
 group emmean   SE df lower.CL upper.CL t.ratio p.value
 A       2.18 0.19 87     1.81     2.56 11.504  &lt;.0001 
 B       1.41 0.19 87     1.03     1.79  7.422  &lt;.0001 
 C       3.16 0.19 87     2.79     3.54 16.671  &lt;.0001 

Results are given on the log (not the response) scale. 
Confidence level used: 0.95 

$contrasts
 contrast estimate    SE df lower.CL upper.CL t.ratio p.value
 A - B       0.775 0.268 87    0.135    1.415  2.886  0.0135 
 A - C      -0.980 0.268 87   -1.620   -0.341 -3.654  0.0013 
 B - C      -1.755 0.268 87   -2.395   -1.115 -6.540  &lt;.0001 

Results are given on the log (not the response) scale. 
Confidence level used: 0.95 
Conf-level adjustment: tukey method for comparing a family of 3 estimates 
P value adjustment: tukey method for comparing a family of 3 estimates </code></pre>
<pre class="r"><code>&gt; ( mcsum2bt &lt;- summary(mc2t,infer=TRUE,type=&quot;response&quot;) )</code></pre>
<pre><code>$emmeans
 group response    SE df lower.CL upper.CL t.ratio p.value
 A         8.87 1.684 87     6.08    12.94 11.504  &lt;.0001 
 B         4.09 0.776 87     2.80     5.96  7.422  &lt;.0001 
 C        23.65 4.488 87    16.22    34.49 16.671  &lt;.0001 

Confidence level used: 0.95 
Intervals are back-transformed from the log scale 
Tests are performed on the log scale 

$contrasts
 contrast ratio     SE df lower.CL upper.CL t.ratio p.value
 A / B    2.170 0.5823 87   1.1442    4.114  2.886  0.0135 
 A / C    0.375 0.1007 87   0.1978    0.711 -3.654  0.0013 
 B / C    0.173 0.0464 87   0.0912    0.328 -6.540  &lt;.0001 

Confidence level used: 0.95 
Conf-level adjustment: tukey method for comparing a family of 3 estimates 
Intervals are back-transformed from the log scale 
P value adjustment: tukey method for comparing a family of 3 estimates 
Tests are performed on the log scale </code></pre>
<p> </p>
</div>
</div>
<div id="iron-and-mining" class="section level1">
<h1>Iron and Mining</h1>
<ol style="list-style-type: decimal">
<li>After <strong>log</strong> transforming, the variances appear to be equal as suggested by the Levene’s test (p=0.4719) and the similarity in the boxes in the boxplot below. The Anderson-Darling test suggests that the residuals are not normally distributed (p=0.0004), but the histogram below is not strongly skewed so this assumption is adequately met. There is no strong evidence for a significant outlier according to the outlier test (p=0.0565).</li>
<li>There appears to be a difference in mean log iron concentration in streams among some of the basin types (ANOVA p&lt;0.00005).</li>
<li>It appears that mean log iron concentration in mines in basins with abandoned mines differs from basins with reclaimed mines (p&lt;0.00005) and basins that were unmined (p&lt;0.00005). The mean log concentration did not differ between streams in basins with reclaimed mines and basins that were not mined (p=0.0694).</li>
<li>The mean log concentration of iron was lowest in streams in the unmined basin at between -1.748 and -0.823.</li>
<li>The back-transformed mean concentration of iron in streams in the unmined basin is between 0.174 mg/L (=e<sup>-1.748</sup>) and 0.439 mg/L (=e<sup>-0.823</sup>).</li>
<li>The mean log concentration of iron in streams in the unmined basin was between 1.392 and 3.006 units less than the mean log concentration of iron in streams in basins with abandoned mines.</li>
<li>The mean concentration of iron in streams in the unmined basin was between 0.050 and 0.248 as large as the mean concentration of iron in streams in the basin with abandoned mines. Alternatively, mean concentration of iron in streams in the basin with abandoned mines was between 4.024 and 20.198 times as large as the mean concentration of iron in streams in the unmined basin.</li>
</ol>
<div id="r-code-and-results.-2" class="section level3">
<h3>R Code and Results.</h3>
<pre class="r"><code>&gt; im &lt;- read.csv(&quot;https://raw.githubusercontent.com/droglenc/NCData/master/AcidMineDrainage.csv&quot;)
&gt; im$use &lt;- factor(im$use,levels=c(&quot;Unmined&quot;,&quot;Reclaimed&quot;,&quot;Abandoned&quot;))
&gt; lm3 &lt;- lm(FE~use,data=im)
&gt; assumptionCheck(lm3,lambday=0)</code></pre>
<p><img src="KEY_ANOVA1Transformations_CE1_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<pre class="r"><code>&gt; im$logFE &lt;- log(im$FE)
&gt; lm3t &lt;- lm(logFE~use,data=im)
&gt; anova(lm3t)</code></pre>
<pre><code>Analysis of Variance Table

Response: logFE
           Df  Sum Sq Mean Sq F value   Pr(&gt;F)
use         2  90.091  45.045  21.743 9.35e-09
Residuals 117 242.392   2.072                 </code></pre>
<pre class="r"><code>&gt; mc3t &lt;- emmeans(lm3t,specs=pairwise~use,tran=&quot;log&quot;)
&gt; ( mcsum3t &lt;- summary(mc3t,infer=TRUE) )</code></pre>
<pre><code>$emmeans
 use       emmean    SE  df lower.CL upper.CL t.ratio p.value
 Unmined   -1.286 0.233 117   -1.748   -0.823 -5.506  &lt;.0001 
 Reclaimed -0.587 0.208 117   -0.998   -0.175 -2.825  0.0056 
 Abandoned  0.913 0.247 117    0.425    1.402  3.700  0.0003 

Results are given on the log (not the response) scale. 
Confidence level used: 0.95 

$contrasts
 contrast              estimate    SE  df lower.CL upper.CL t.ratio p.value
 Unmined - Reclaimed     -0.699 0.313 117    -1.44   0.0432 -2.236  0.0694 
 Unmined - Abandoned     -2.199 0.340 117    -3.01  -1.3923 -6.472  &lt;.0001 
 Reclaimed - Abandoned   -1.500 0.323 117    -2.27  -0.7343 -4.650  &lt;.0001 

Results are given on the log (not the response) scale. 
Confidence level used: 0.95 
Conf-level adjustment: tukey method for comparing a family of 3 estimates 
P value adjustment: tukey method for comparing a family of 3 estimates </code></pre>
<pre class="r"><code>&gt; ( mcsum3bt &lt;- summary(mc3t,infer=TRUE,type=&quot;response&quot;) )</code></pre>
<pre><code>$emmeans
 use       response     SE  df lower.CL upper.CL t.ratio p.value
 Unmined      0.276 0.0646 117    0.174    0.439 -5.506  &lt;.0001 
 Reclaimed    0.556 0.1155 117    0.369    0.839 -2.825  0.0056 
 Abandoned    2.493 0.6153 117    1.529    4.064  3.700  0.0003 

Confidence level used: 0.95 
Intervals are back-transformed from the log scale 
Tests are performed on the log scale 

$contrasts
 contrast              ratio     SE  df lower.CL upper.CL t.ratio p.value
 Unmined / Reclaimed   0.497 0.1554 117   0.2368    1.044 -2.236  0.0694 
 Unmined / Abandoned   0.111 0.0377 117   0.0495    0.248 -6.472  &lt;.0001 
 Reclaimed / Abandoned 0.223 0.0720 117   0.1037    0.480 -4.650  &lt;.0001 

Confidence level used: 0.95 
Conf-level adjustment: tukey method for comparing a family of 3 estimates 
Intervals are back-transformed from the log scale 
P value adjustment: tukey method for comparing a family of 3 estimates 
Tests are performed on the log scale </code></pre>
<pre class="r"><code>&gt; p1 &lt;- ggplot() +
    geom_jitter(data=im,mapping=aes(x=use,y=FE),alpha=0.25,width=0.05) +
    geom_errorbar(data=mcsum3bt$emmeans,
                  mapping=aes(x=use,y=response,ymin=lower.CL,ymax=upper.CL),
                  size=2,width=0) +
    geom_point(data=mcsum3bt$emmeans,mapping=aes(x=use,y=response),
                 size=2,pch=21,fill=&quot;white&quot;) +
    labs(y=&quot;Iron Concentration&quot;,x=&quot;Land Use Category&quot;) +
    theme_NCStats()
&gt; p1
&gt; p1 +
    coord_cartesian(ylim=c(0,10))</code></pre>
<p><img src="KEY_ANOVA1Transformations_CE1_files/figure-html/unnamed-chunk-7-1.png" width="336" /><img src="KEY_ANOVA1Transformations_CE1_files/figure-html/unnamed-chunk-7-2.png" width="336" /></p>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
