---
layout: page
title: "One-Way ANOVA"
subtitle: R Handout
author: "Derek H. Ogle"
css: "/css/modules.css"
---
</div>


<pre class="r"><code>&gt; options(show.signif.stars=FALSE)
&gt; library(NCStats)
&gt; library(multcomp)     # for glht()</code></pre>
<hr />
<div id="raspberry-example" class="section level1">
<h1>Raspberry Example</h1>
<p>A researcher is interested in the effect of irrigation on fruit production by raspberry plants. The researcher has determined that he will examine the effects of 100 ml (a maintenance amount), 200, 400, and 800 ml of water per pot. The researcher had 16 identical planting pots available and much more than that number of raspberry plant seedlings. A square table for growing the plants in a greenhouse is available. He had enough time to let the plants mature (i.e., produce berries) or not. At the end of this period, the total weight (g) of mature berries was recorded.</p>
<pre class="r"><code>&gt; setwd(&quot;C:/aaaWork/Web/GitHub/NCMTH207/modules/Anova-1Way&quot;)
&gt; rasp &lt;- read.csv(&quot;Raspberry.csv&quot;)
&gt; str(rasp)</code></pre>
<pre><code>&#39;data.frame&#39;:   16 obs. of  2 variables:
 $ water : int  100 100 100 100 200 200 200 200 400 400 ...
 $ weight: num  8.1 10.9 11.1 13.9 12.2 11.5 11.4 6.8 6.5 5.5 ...</code></pre>
<pre class="r"><code>&gt; rasp$water &lt;- factor(rasp$water)
&gt; str(rasp)</code></pre>
<pre><code>&#39;data.frame&#39;:   16 obs. of  2 variables:
 $ water : Factor w/ 4 levels &quot;100&quot;,&quot;200&quot;,&quot;400&quot;,..: 1 1 1 1 2 2 2 2 3 3 ...
 $ weight: num  8.1 10.9 11.1 13.9 12.2 11.5 11.4 6.8 6.5 5.5 ...</code></pre>
<div id="fitting-the-linear-model" class="section level2">
<h2>Fitting the Linear Model</h2>
<pre class="r"><code>&gt; lm1 &lt;- lm(weight~water,data=rasp)
&gt; anova(lm1)</code></pre>
<pre><code>          Df  Sum Sq Mean Sq F value   Pr(&gt;F)
water      3 115.042  38.347  10.793 0.001004
Residuals 12  42.635   3.553                 </code></pre>
<pre class="r"><code>&gt; cbind(Ests=coef(lm1),confint(lm1))</code></pre>
<pre><code>              Ests     2.5 %    97.5 %
(Intercept) 11.000  8.946558 13.053442
water200    -0.525 -3.429006  2.379006
water400    -5.625 -8.529006 -2.720994
water800    -5.600 -8.504006 -2.695994</code></pre>

<pre class="r"><code>&gt; fitPlot(lm1,xlab=&quot;Water Treatment (ml)&quot;,ylab=&quot;Weight (g)&quot;)</code></pre>
<p><img src="RHO_files/figure-html/unnamed-chunk-8-1.png" width="288" /></p>
</div>
<div id="checking-assumptions" class="section level2">
<h2>Checking Assumptions</h2>
<pre class="r"><code>&gt; transChooser(lm1)</code></pre>
<p><img src="TCRasp1.jpg" width="6in" /></p>

</div>
<div id="multiple-comparison-tests" class="section level2">
<h2>Multiple Comparison Tests</h2>
<pre class="r"><code>&gt; rasp.mc &lt;- glht(lm1, mcp(water = &quot;Tukey&quot;))
&gt; summary(rasp.mc)</code></pre>
<pre><code>              Estimate Std. Error     t value     p value
200 - 100 = 0   -0.525   1.332838 -0.39389620 0.978302479
400 - 100 = 0   -5.625   1.332838 -4.22031642 0.005735483
800 - 100 = 0   -5.600   1.332838 -4.20155946 0.005792517
400 - 200 = 0   -5.100   1.332838 -3.82642022 0.011260923
800 - 200 = 0   -5.075   1.332838 -3.80766326 0.011580221
800 - 400 = 0    0.025   1.332838  0.01875696 0.999997485</code></pre>
<pre class="r"><code>&gt; confint(rasp.mc)</code></pre>
<pre><code>          Estimate      lwr      upr
200 - 100   -0.525 -4.47969  3.42969
400 - 100   -5.625 -9.57969 -1.67031
800 - 100   -5.600 -9.55469 -1.64531
400 - 200   -5.100 -9.05469 -1.14531
800 - 200   -5.075 -9.02969 -1.12031
800 - 400    0.025 -3.92969  3.97969</code></pre>
<pre class="r"><code>&gt; fitPlot(lm1,xlab=&quot;Water Treatment (ml)&quot;,ylab=&quot;Weight (g)&quot;)
&gt; addSigLetters(lm1,lets=c(&quot;a&quot;,&quot;a&quot;,&quot;b&quot;,&quot;b&quot;),pos=c(2,4,2,4))</code></pre>
<p><img src="RHO_files/figure-html/unnamed-chunk-15-1.png" width="288" /></p>
<hr />

</div>
</div>
<div id="benthic-infaunal-example" class="section level1">
<h1>Benthic Infaunal Example</h1>
<p>To examine the effect of effluent releases on benthic organisms in the release area, researchers recorded the total abundance of benthic organisms at eight haphazardly-selected sublocations at each of eight control locations (thought to have not been impacted by the effluent release) and one potentially impacted location. Use the data in <code>BenthicInfaunal.csv</code> to determine if the mean abundance of benthic organisms differs between the locations (and, especially, if the impacted location differs from any of the control locations).</p>
<pre class="r"><code>&gt; ben &lt;- read.csv(&quot;BenthicInfaunal.csv&quot;)
&gt; ben$site &lt;- factor(ben$site)
&gt; str(ben)</code></pre>
<pre><code>&#39;data.frame&#39;:   72 obs. of  2 variables:
 $ site     : Factor w/ 9 levels &quot;1&quot;,&quot;2&quot;,&quot;3&quot;,&quot;4&quot;,..: 1 1 1 1 1 1 1 1 2 2 ...
 $ abundance: num  14.4 20.4 21.2 17.6 29 ...</code></pre>
<div id="assumption-checking-with-possible-transformations" class="section level2">
<h2>Assumption Checking with Possible Transformations</h2>
<pre class="r"><code>&gt; lm2 &lt;- lm(abundance~site,data=ben)</code></pre>
<pre class="r"><code>&gt; transChooser(lm2)</code></pre>
<p><img src="TCBenthic1.jpg" width="6in" /></p>
<pre class="r"><code>&gt; transChooser(lm2)  # interactively adjust lambdas</code></pre>
<p><img src="TCBenthic2.jpg" width="6in" /></p>
<pre class="r"><code>&gt; ben$logab &lt;- log(ben$abundance)
&gt; lm3 &lt;- lm(logab~site,data=ben)</code></pre>
</div>
<div id="model-summarization" class="section level2">
<h2>Model Summarization</h2>
<pre class="r"><code>&gt; anova(lm3)</code></pre>
<pre><code>          Df Sum Sq Mean Sq F value    Pr(&gt;F)
site       8 8.6683 1.08353  29.066 &lt; 2.2e-16
Residuals 63 2.3485 0.03728                  </code></pre>
<pre class="r"><code>&gt; ben.mc &lt;- glht(lm3, mcp(site = &quot;Dunnett&quot;))
&gt; summary(ben.mc)</code></pre>
<pre><code>             Estimate Std. Error     t value      p value
2 - 1 = 0 -0.21843454 0.09653725 -2.26269698 1.457145e-01
3 - 1 = 0  0.70318863 0.09653725  7.28411718 5.074021e-09
4 - 1 = 0  0.45383639 0.09653725  4.70115314 1.037786e-04
5 - 1 = 0 -0.41485933 0.09653725 -4.29740160 4.439483e-04
6 - 1 = 0 -0.00423765 0.09653725 -0.04389653 1.000000e+00
7 - 1 = 0  0.14028047 0.09653725  1.45312275 5.796810e-01
8 - 1 = 0 -0.37186732 0.09653725 -3.85206051 1.932862e-03
9 - 1 = 0  0.16866808 0.09653725  1.74718135 3.798308e-01</code></pre>

<pre class="r"><code>&gt; fitPlot(lm3,ylab=&quot;Log Abundance&quot;,xlab=&quot;Site&quot;)
&gt; addSigLetters(lm3,lets=c(&quot;&quot;,&quot;&quot;,&quot;*&quot;,&quot;*&quot;,&quot;*&quot;,&quot;&quot;,&quot;&quot;,&quot;*&quot;,&quot;&quot;),pos=c(2,4,2,4,2,2,4,2,4))</code></pre>
<p><img src="RHO_files/figure-html/unnamed-chunk-27-1.png" width="288" /></p>
<pre class="r"><code>&gt; confint(ben.mc)</code></pre>
<pre><code>         Estimate         lwr         upr
2 - 1 -0.21843454 -0.48189860  0.04502952
3 - 1  0.70318863  0.43972457  0.96665269
4 - 1  0.45383639  0.19037233  0.71730045
5 - 1 -0.41485933 -0.67832339 -0.15139527
6 - 1 -0.00423765 -0.26770171  0.25922641
7 - 1  0.14028047 -0.12318359  0.40374453
8 - 1 -0.37186732 -0.63533138 -0.10840327
9 - 1  0.16866808 -0.09479598  0.43213214</code></pre>
<pre class="r"><code>&gt; exp(confint(ben.mc)$confint)</code></pre>
<pre><code>       Estimate       lwr       upr
2 - 1 0.8037761 0.6176728 1.0459518
3 - 1 2.0201841 1.5524383 2.6288605
4 - 1 1.5743404 1.2098236 2.0486853
5 - 1 0.6604332 0.5075190 0.8594201
6 - 1 0.9957713 0.7652142 1.2957947
7 - 1 1.1505965 0.8841917 1.4972683
8 - 1 0.6894457 0.5298140 0.8971740
9 - 1 1.1837272 0.9096514 1.5403812</code></pre>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
