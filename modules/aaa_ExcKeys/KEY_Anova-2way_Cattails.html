---
layout: page
title: "Exercise Key"
subtitle: "Two-Way ANOVA"
author: Derek H. Ogle
css: "/css/modules.css"
---


<hr />
<div id="anova-table" class="section level2">
<h2>ANOVA Table</h2>
<div class="alert alert-warning">
<strong>Note:</strong>
<ul>
<li>
The key is to construct a table of means similar to Table 1. Then SS<sub>habitat</sub>, SS<sub>year</sub> and SS<sub>among</sub> are computed by following the SS<sub>row</sub>, SS<sub>column</sub> and SS<sub>among</sub> formulas from the reading and class notes. The SS<sub>interaction</sub> is then found by subtracting both SS<sub>habitat</sub> and SS<sub>year</sub> from SS<sub>among</sub>. The SS<sub>within</sub> is found by subtracting SS<sub>among</sub> from SS<sub>total</sub>. All degrees-of-freedom are found by formulae in the reading and class notes, noting that r=2, c=2 and n=25 (remember that n is the number of replicates per treatment in a two-way ANOVA, not the total number of individuals). The MS, F (but note that the denominator is always MS<sub>within</sub>), and p-values are found as usual.
</li>
<li>
I did this in R just for fun (you did not have to use R except for the p-values).
</li>
</ul>
</div>
<p>Table 1: Means table for cattail data.</p>
<table class="huxtable" style="border-collapse: collapse; margin-bottom: 2em; margin-top: 2em; width: 50%; margin-left: auto; margin-right: auto;  ">
<col><col><col><col><tr>
<td style="vertical-align: top; text-align: center; white-space: nowrap; padding: 4pt 4pt 4pt 4pt; font-weight: bold;"></td>
<td style="vertical-align: top; text-align: center; white-space: nowrap; padding: 4pt 4pt 4pt 4pt; font-weight: bold;">far</td>
<td style="vertical-align: top; text-align: center; white-space: nowrap; padding: 4pt 4pt 4pt 4pt; font-weight: bold;">near</td>
<td style="vertical-align: top; text-align: center; white-space: nowrap; padding: 4pt 4pt 4pt 4pt; font-weight: bold;">mean</td>
</tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: nowrap; padding: 4pt 4pt 4pt 4pt; font-weight: bold;">2015</td>
<td style="vertical-align: top; text-align: center; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">75.45</td>
<td style="vertical-align: top; text-align: center; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">74.46</td>
<td style="vertical-align: top; text-align: center; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">74.95</td>
</tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: nowrap; padding: 4pt 4pt 4pt 4pt; font-weight: bold;">2016</td>
<td style="vertical-align: top; text-align: center; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">83.98</td>
<td style="vertical-align: top; text-align: center; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">80.70</td>
<td style="vertical-align: top; text-align: center; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">82.34</td>
</tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: nowrap; padding: 4pt 4pt 4pt 4pt; font-weight: bold;">mean</td>
<td style="vertical-align: top; text-align: center; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">79.72</td>
<td style="vertical-align: top; text-align: center; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">77.58</td>
<td style="vertical-align: top; text-align: center; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">78.65</td>
</tr>
</table>

<p> </p>
<p>Results shown in Table 2. R code to make calculations are shown in an appendix (note, however, that you are not expected to make these calculations in R).</p>
<p> </p>
<p>Table 2: Completed analysis of variance table for cattail data.</p>
<table class="huxtable" style="border-collapse: collapse; margin-bottom: 2em; margin-top: 2em; width: 70%; margin-left: auto; margin-right: auto;  ">
<col><col><col><col><col><col><tr>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt; font-weight: bold;"></td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt; font-weight: bold;">df</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt; font-weight: bold;">SS</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt; font-weight: bold;">MS</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt; font-weight: bold;">F</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt; font-weight: bold;">p</td>
</tr>
<tr>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt; font-weight: bold;">Among</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">3</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">1510.2</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">503.4</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">2.582</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">0.0579</td>
</tr>
<tr>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt; font-weight: bold;">Habitat</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">1</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">1365.3</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">1365.3</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">7.003</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">0.0095</td>
</tr>
<tr>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt; font-weight: bold;">Year</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">1</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">114.5</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">114.5</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">0.587</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">0.4454</td>
</tr>
<tr>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt; font-weight: bold;">Interaction</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">1</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">30.4</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">30.4</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">0.156</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">0.6939</td>
</tr>
<tr>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt; font-weight: bold;">Within</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">96</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">18717.1</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">195.0</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;"></td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;"></td>
</tr>
<tr>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt; font-weight: bold;">Total</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">99</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt; font-style: italic;">20227.3</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;"></td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;"></td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;"></td>
</tr>
</table>

<p>R Appendix.</p>
<pre class="r"><code>library(NCStats)
tmns &lt;- matrix(c(75.45,83.98,74.46,80.70),byrow=FALSE,nrow=2)
colnames(tmns) &lt;- c(&quot;far&quot;,&quot;near&quot;)
rownames(tmns) &lt;- c(&quot;2015&quot;,&quot;2016&quot;)
mns &lt;- addmargins(tmns,FUN=mean,quiet=TRUE)
mns &lt;- round(mns,2)
r &lt;- c &lt;- 2
n &lt;- 25
ssyear &lt;- r*n*sum((mns[1:2,3]-mns[3,3])^2)
sshab &lt;- r*n*sum((mns[3,1:2]-mns[3,3])^2)
ssamong &lt;- n*sum((mns[1:2,1:2]-mns[3,3])^2)
ssint &lt;- ssamong-sshab-ssyear
sstotal &lt;- 20227.3
sswithin &lt;- sstotal-ssamong
dfamong &lt;- r*c-1
dfyear &lt;- r-1
dfhab &lt;- c-1
dfint &lt;- dfamong-dfhab-dfyear
dftotal &lt;- r*c*n-1
dfwithin &lt;- dftotal-dfamong
ss &lt;- c(ssamong,ssyear,sshab,ssint,sswithin)
df &lt;- c(dfamong,dfyear,dfhab,dfint,dfwithin)
ms &lt;- ss/df
F &lt;- ms[-length(ms)]/ms[length(ms)]
distrib(F[1],df1=df[1],df2=df[5],distrib=&quot;f&quot;,lower.tail=FALSE)
distrib(F[2],df1=df[2],df2=df[5],distrib=&quot;f&quot;,lower.tail=FALSE)
distrib(F[3],df1=df[3],df2=df[5],distrib=&quot;f&quot;,lower.tail=FALSE)
distrib(F[4],df1=df[4],df2=df[5],distrib=&quot;f&quot;,lower.tail=FALSE)</code></pre>
<hr />
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
