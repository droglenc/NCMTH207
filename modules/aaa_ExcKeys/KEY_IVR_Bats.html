---
layout: page
title: "Exercise Key"
subtitle: "Indicator Variable Regression"
author: Derek H. Ogle
css: "/css/modules.css"
---


<hr />
<div class="alert alert-warning">
<strong>Note:</strong>
<ul>
<li>
The indicator variable is named after the “1” group. The reference group will not be explicitly stated in the indicator variables, but is defined when all indicator variables are 0.
</li>
<li>
The variables are entered into the ultimate full model in this order – covariate, all indicator variables, and all interaction variables.
</li>
<li>
The submodel for the “1-day starved” group is found by plugging in 0 for ALL indicatory variables and then simplifying. Essentially everything in the ultimate full model multiplied by an indicator variable is dropped.
</li>
<li>
The submodel for the “4-day starve” group is found by plugging in 1 for FOUR and 0 for the other indicator variables and then simplifying. Essentially everything in the ultimate full model multiplied by one of the other indicator variable is dropped. Additionally, the word FOUR is dropped and then the two constants (α and δ<sub>1</sub>) are lumped together and the two items multiplied by the covariate (β and γ<sub>1</sub>) are lumped together. A similar argument is made for the other groups.
</li>
</ul>
</div>
<hr />
<div id="bat-morphology" class="section level2">
<h2>Bat Morphology</h2>
<ol>
<li><p>As there are three groups in this analysis and the “phytophagous” bats are to be the reference group, I created the following two indicator variables.</p>
<ul>
<li>AI=1 if in the “aerial insectivor” group, 0 otherwise</li>
<li>G=1 if in the “gleaner” group, 0 otherwise</li>
</ul>
<p>The ultimate full model is then μ<sub>ANV</sub> = α + βWT + δ<sub>1</sub>AI + δ<sub>2</sub>G + γ<sub>1</sub>AI×WT + γ<sub>2</sub>G×WT, where ANV is “auditory nuclei volume” and WT is “body weight” of the bats.</p></li>
<li><p>The submodels for all three groups are below.</p>
<ul>
<li>phytophagous: μ<sub>ANV</sub> = α + βWT</li>
<li>aerial insectivor: μ<sub>ANV</sub> = (α+δ<sub>1</sub>) + (β+γ<sub>1</sub>)WT</li>
<li>gleaner: μ<sub>ANV</sub> = (α+δ<sub>2</sub>) + (β+γ<sub>3</sub>)WT</li>
</ul></li>
<li><p>The data appear to be independent as each individual is a separate species and no species is simultaneously grouped into two diet categories. There is some evidence for a slight non-linearity within the groups (Figure 1-Right). The residual plot (Figure 1-Right) also suggests heteroscedasticity. The residuals do not appear to be normal (Anderson Darling p&lt;0.00005) and are right-skewed (Figure 1-Left). There appears to be a significant outlier (outlier test p&lt;0.00005).</p>
<p>A trial-and-error method (i.e., use of <code>transChooser</code>) was used to determine that the auditory nuclei mass variable should be transformed with the natural logarithm. In addition, although the maximum to minimum ratio does not warrant it and none of the major regression assumptions are violated without it, the model appears to have no influential observations if the body weight variable is also transformed with natural logarithms. With both variables transformed to the natural log scale, the model appeared linear within the groups (Figure 2-Left), the residuals were homoscedastic (Figure 2-Right) and normal (Anderson Darling p=0.0818; Figure 2-Left), and there were no outlies (outlier test p=0.7696). Thus, the assumptions were adequately met on the log-log scale and all further analyses were conducted on this scale.</p></li>
<li><p>The slopes between log auditory nuclei mass and log body weight were statistically similar among the three diet groups (p=0.1308; Table 1); thus, the lines that describe the relationship between log auditory nuclei mass and log body weight for the separate groups of bats are all parallel.</p></li>
<li><p>The intercepts (assuming parallel lines) for the lines describing the relationship between log auditory nuclei mass and log body weight were statistically similar among the three diet groups (p=0.1586; Table 1); thus, the lines all have the same intercept. Coupled with the observation that the lines were parallel, this result indicates that the lines are coincident among the three groups.</p></li>
<li><p>A plot that illustrates the model fit is in Figure 3.</p></li>
<li><p>The results of the previous analysis show that the relationship between log auditory nuclei mass and log body weight can be modeled by the same line for each of the three different diet groups Figure 3. In other words, there was no difference in the relationship between log auditory nuclei mass and log body weight among the three diet groups. In addition, at any given log body weight there was no difference in log auditory nuclei mass among the three groups. There was, however, a significant positive relationship between log auditory nuclei mass and log body weight. In fact, it appears that as the log body weight increases by 1 g, the log auditory nuclei volume will increase between 0.31 and 0.47 mm<sup>3</sup>.</p></li>
</ol>
<p><img src="KEY_IVR_Bats_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<p>Figure 1: Histogram of residuals (left) and residual plot (right) for indicator variable regression of auditory nuclei volume on bat body weight for three different diet groups.</p>
<p><img src="KEY_IVR_Bats_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<p>Figure 2: Histogram of residuals (left) and residual plot (right) for indicator variable regression of log-transformed auditory nuclei volume on log-transformed bat body weight for three different diet groups.</p>
<p><img src="KEY_IVR_Bats_files/figure-html/unnamed-chunk-5-1.png" width="432" /></p>
<p>Figure 3: Scatterplot of log-transformed auditory nuclei volume on log-transformed bat body weight for three different diet groups with best-fit lines.</p>
<p>Table 1: ANOVA table for the indicator variable regression of log-transformed auditory nuclei volume on log-transformed bat body weight for three different diet groups.</p>
<pre><code>               Df  Sum Sq Mean Sq  F value    Pr(&gt;F)
logbodywt       1 13.2492 13.2492 102.4449 3.614e-14
diet            2  0.4927  0.2463   1.9047    0.1586
logbodywt:diet  2  0.5462  0.2731   2.1116    0.1308
Residuals      55  7.1131  0.1293                   </code></pre>
<p>R Appendix.</p>
<pre class="r"><code>b &lt;- read.csv(&quot;Batmorph2.csv&quot;)
b &lt;- filterD(b,diet!=&quot;vampire&quot;)
b$diet &lt;- relevel(b$diet,&quot;phytophage&quot;)
lm1 &lt;- lm(audnuc~bodywt*diet,data=b)
transChooser(lm1)
b$logaudnuc &lt;- log(b$audnuc)
b$logbodywt &lt;- log(b$bodywt)
lm2 &lt;- lm(logaudnuc~logbodywt*diet,data=b)
anova(lm2)
fitPlot(lm2,xlab=&quot;Log(Body Weight (g))&quot;,
        ylab=&quot;Log(Auditory Nuclei Volume (mm^3))&quot;,
        legend=&quot;topleft&quot;)
lm3 &lt;- lm(logaudnuc~logbodywt,data=b)
confint(lm3)</code></pre>
<hr />
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
