---
title: "Exercise Key"
subtitle: "Logistic Regression"
author: Derek H. Ogle
layout: page
css: "/css/modules.css"
output:
  html_document:
    fig_height: 3.5
    fig_width: 3.5
    self_contained: false
---

```{r echo=FALSE, eval=FALSE, warning=FALSE}
## Renders an appropriate HTML file and moves to CE directory
source("modules/aaa_ExcKeys/aaa_rmd/zzz_modHTML_CEKeys.R")
modHTML_CEKeys("KEY_Logistic_XXX")
```

```{r echo=FALSE, results='hide', message=FALSE, warning=FALSE}
library(NCStats)
source("../../../rhelpers/knitr_setup.R")

df <- read.csv("https://raw.githubusercontent.com/droglenc/NCData/master/XMovieAge.csv")
df <- filterD(df,age<96)
glm1 <- glm(seen~age,data=df,family=binomial)
cf1 <- coef(glm1)
ci1 <- confint(glm1)
log50 <- predict(glm1,data.frame(age=50))
p50 <- predict(glm1,data.frame(age=50),type="response")
p30 <- predict(glm1,data.frame(age=30),type="response")
p31 <- predict(glm1,data.frame(age=31),type="response")

library(captioner)
tbls <- captioner(prefix="Table")
figs <- captioner(prefix="Figure")
figs(name="fitplot","Fitted plot for the logistic regression of whether or not the respondent had seen an x-rated movie and the respondent's age.")
```

----

<div class="alert alert-warning">
<strong>Note:</strong> 
<ul>
  <li>XXX</li>
</ul>
</div>

----

## X-Rated Movies

1. The logistic regression model sseem to fit the proportions of respondents that had seen an x-rated movie by age (i.e., blue pluses; `r figs("fitplot",display="cite")`).
1. The estimated slope indicates that the log odds that a respondent has seen an x-rated movie decrease between `r formatC(-1*ci1[2,2],format="f",digits=4)` and `r formatC(-1*ci1[2,1],format="f",digits=4)`, on average, for every increase in age by one year.
1. The back-transformed estimated slopes indicates that the odds that a respondent has seen an x-rated movie are between `r formatC(exp(ci1[2,1]),format="f",digits=4)` and `r formatC(exp(ci1[2,2]),format="f",digits=4)` as much after an increase of one year.
1. The log odds of having seen an x-rated movie for a 50-year-old is computed with `r formatC(cf1[1],format="f",digits=4)`+`r formatC(cf1[2],format="f",digits=4)`*50 = `r formatC(log50,format="f",digits=4)`.
1. The log odds of having seen an x-rated movie for a 50-year-old as computed in R is also `r formatC(log50,format="f",digits=4)` (see code in appendix).
1. The odds of having seen an x-rated for a 50-year-old is `r formatC(exp(log50),format="f",digits=4)` as computed with $e^{`r formatC(log50,format="f",digits=4)`}$.
1. The probability of having seen an x-rated for a 50-year-old is computed with $\frac{`r formatC(exp(log50),format="f",digits=4)`}{1+`r formatC(exp(log50),format="f",digits=4)`}$=`r formatC(p50,format="f",digits=4)`.
1. The probability of having seen an x-rated for a 50-year-old as computed in R is `r formatC(p50,format="f",digits=4)` (see code in appendix).
1. The probability of having seen an x-rated movie for a 30-year old is `r formatC(p30,format="f",digits=4)`. Thus, the odds that a 30-year old has seen an x-rated movie is $\frac{`r formatC(p30,format="f",digits=4)`}{1-`r formatC(p30,format="f",digits=4)`}$=`r formatC(p30/(1-p30),format="f",digits=4)`.
1. The probability of having seen an x-rated movie for a 31-year old is `r formatC(p31,format="f",digits=4)`. Thus, the odds that a 31-year old has seen an x-rated movie is $\frac{`r formatC(p31,format="f",digits=4)`}{1-`r formatC(p31,format="f",digits=4)`}$=`r formatC(p31/(1-p31),format="f",digits=4)`. The ratio of the odds for the 31-year-old to the odds of the 30-year-old is $\frac{`r formatC(p31/(1-p31),format="f",digits=4)`}{`r formatC(p30/(1-p30),format="f",digits=4)`}$ = `r formatC(exp(cf1[2]),format="f",digits=4)`, which is the same as the back-transformed slope (i.e., $e^{`r formatC(cf1[2],format="f",digits=4)`}$).


```{r echo=FALSE, par1=TRUE}
fitPlot(glm1,xlab="Age (yrs)",ylab="Seen an X-Rated Movie?")
```

`r figs("fitplot")`


R Appendix.
```{r eval=FALSE, prompt=FALSE}
df <- read.csv("XMovieAge.csv")
df <- filterD(df,age<96)
glm1 <- glm(seen~age,data=df,family=binomial)
coef(glm1)
confint(glm1)
predict(glm1,data.frame(age=50))
predict(glm1,data.frame(age=50),type="response")
predict(glm1,data.frame(age=30),type="response")
predict(glm1,data.frame(age=31),type="response")
```

----
