---
title: "Exercise Key"
subtitle: "Simple Linear Regression"
author: Derek H. Ogle
layout: page
css: "/css/modules.css"
output:
  html_document:
    fig_height: 3.5
    fig_width: 3.5
    self_contained: false
---

```{r echo=FALSE, eval=FALSE, warning=FALSE}
## Renders an appropriate HTML file and moves to CE directory
source("modules/aaa_ExcKeys/aaa_rmd/zzz_modHTML_CEKeys.R")
modHTML_CEKeys("KEY_SLR_Ashland")
```

```{r echo=FALSE, results='hide', message=FALSE, warning=FALSE}
library(NCStats)
source("../../../rhelpers/knitr_setup.R")

d2 <- data.frame(mon=c("Jan","Feb","Mar","Apr","May","Jun",
                       "Jul","Aug","Sep","Oct","Nov","Dec"),
                 ahi=c(-5.4,-2.7,2.8,10.6,18.3,22.7,
                       25.6,24.9,20.2,12.6,4.1,-3.3),
                 alo=c(-15.4,-13.1,-8.2,-2.2,3.8,9.1,
                       12.7,11.4,7.2,1.3,-4.7,-11.8),
                 aprecip=c(20,19,34,65,78,97,
                           109,90,98,83,46,20))
lm2 <- lm(aprecip~ahi,data=d2)
sum2 <- summary(lm2)
ci2 <- confint(lm2)
pred1 <- predict(lm2,data.frame(ahi=10),interval="confidence")
pred2 <- predict(lm2,data.frame(ahi=10),interval="prediction")

library(captioner)
tbls <- captioner(prefix="Table")
figs <- captioner(prefix="Figure")
tbls(name="coef","Summary of the linear regression of proportion of average monthly preciptation on average high temperature for Ashland, WI.")
tbls(name="ci","Confidence intervals for coefficients of the linear regression of average monthly preciptation on average high temperature for Ashland, WI.")
figs(name="fitplot","Scatterplot of average monthly preciptation and average high temperature for Ashland, WI with the best-fit line.")
```

----

<div class="alert alert-warning">
<strong>Note:</strong> 
<ul>
  <li>When discussing whether there is a relationship between the response and the explanatory variable you must explicitly note that you are referring to the slope p-value. You cannot just refer the reader to the "p-value" in the table from `summary()` because there are three p-values in that table. Be precise with your language!!</li>
  <li>Remember to use CI when describing rates of change (i.e., slopes) or predictions; don't just use the best estimate.</li>
</ul>
</div>

----

## Ashland Climate

1. Yes, there is a signficant relationship between average precipitation and average high temperature for Ashland, WI (`r kPvalue(sum2$coefficients["ahi","Pr(>|t|)"],digits=3)`; `r tbls("coef",display="cite")`). Specifically, as the average high temperature increases by 1<sup>o</sup>C the mean average precipitation increases between `r formatC(ci2["ahi",1],format="f",digits=1)` and `r formatC(ci2["ahi",2],format="f",digits=1)` mm `r tbls("ci",display="cite")`.

1. The y-intercept value suggests that the mean average monthly preciptation for all months with an average high temperature of 0<sup>o</sup>C is between `r formatC(ci2["(Intercept)",1],format="f",digits=1)` and `r formatC(ci2["(Intercept)",2],format="f",digits=1)` mm `r tbls("ci",display="cite")`.

1. Mean average preciptation for all months with an average high of 10<sup>o</sup>C is between `r formatC(pred1[1,"lwr"],format="f",digits=1)` and `r formatC(pred1[1,"upr"],format="f",digits=1)` mm.

  \item The mean average preciptation for a month with an average high of 10<sup>o</sup>C is between `r formatC(pred2[1,"lwr"],format="f",digits=1)` and `r formatC(pred2[1,"upr"],format="f",digits=1)` mm.

  \item The prediction interval for the individual (question 4) is wider than the confidence interval for the mean (question 3) because there is more variability in predicting an individual as compared to a mean. Variability for predicting an individual includes both sampling and natural variability, whereas variability for the mean includes only sampling variability.

1. The relationship between average precipitation and average high temperature is illustrated in `r figs("fitplot",display="cite")`.

&nbsp;

`r tbls("coef")`

```{r echo=FALSE, background="white"}
kREG(lm2)
```

`r tbls("ci")`

```{r echo=FALSE, background="white"}
ci2
```

```{r echo=FALSE, par1=TRUE}
fitPlot(lm2,xlab="Average High Temperature (C)",ylab="Average Preciptation (mm)")
```

`r figs("fitplot")`


R Appendix.
```{r eval=FALSE, prompt=FALSE}
d2 <- read.csv("Ashland.csv")
lm2 <- lm(aprecip~ahi,data=d2)
summary(lm2)
confint(lm2)
predict(lm2,data.frame(ahi=10),interval="confidence")
predict(lm2,data.frame(ahi=10),interval="prediction")
fitPlot(lm2,xlab="Average High Temperature (C)",ylab="Average Preciptation (mm)")
```

----
