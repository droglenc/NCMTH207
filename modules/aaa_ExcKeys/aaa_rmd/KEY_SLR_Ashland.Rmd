---
title: "Exercise Key"
subtitle: "Simple Linear Regression"
author: Derek H. Ogle
layout: page
css: "/css/modules.css"
output:
  html_document:
    fig_height: 3.5
    fig_width: 3.5
    self_contained: false
---

```{r echo=FALSE, eval=FALSE, warning=FALSE}
## Renders an appropriate HTML file and moves to CE directory
source("modules/aaa_ExcKeys/aaa_rmd/zzz_modHTML_CEKeys.R")
modHTML_CEKeys("KEY_SLR_Births")
```

```{r echo=FALSE, results='hide', message=FALSE, warning=FALSE}
library(NCStats)
source("../../../rhelpers/knitr_setup.R")

d1 <- data.frame(year=1970:1990,
                 propmale=c(0.5134,0.5126,0.5125,0.5128,0.5133,0.5132,0.5128,
                            0.5128,0.5129,0.5127,0.5129,0.5126,0.5123,0.5127,
                            0.5122,0.5126,0.5122,0.5120,0.5121,0.5120,0.5120))
lm1 <- lm(propmale~year,data=d1)
sum1 <- summary(lm1)
ci1 <- confint(lm1)

library(captioner)
tbls <- captioner(prefix="Table")
figs <- captioner(prefix="Figure")
tbls(name="coef","Summary of the linear regression of proportion of males on year.")
tbls(name="ci","Confidence intervals for coefficients of the linear regression of proportion of males on year.")
figs(name="fitplot","Scatterplot of the proportion of male births by year with the best-fit line.")
```

----

<div class="alert alert-warning">
<strong>Note:</strong> 
<ul>
  <li>When discussing whether there is a relationship between the response and the explanatory variable you must explicitly note that you are referring to the slope p-value. You cannot just refer the reader to the "p-value" in the table from `summary()` because there are three p-values in that table. Be precise with your language!!</li>
  <li>Remember to use CI when describing rates of change (i.e., slopes) or predictions; don't just use the best estimate.</li>
</ul>
</div>

----

## Male-Female Birth Ratio

1. Yes there is evidence for a significant statistical change in the proportion of male births over the study period because the p-value for the slope (and the equivalent overall F p-value) is very small (`r kPvalue(sum1$coefficients["year","Pr(>|t|)"],digits=3,latex=FALSE)`; `r tbls("coef",display="cite")`).

1. The proportion of males **declined** between `r formatC(-1*ci1["year",2],format="f",digits=6)` and `r formatC(-1*ci1["year",1],format="f",digits=6)` per year, on average (`r tbls("ci",display="cite")`).

1. The relationship between the proportion of male births and year is illustrated in `r figs("fitplot",display="cite")`.

1. The very small slope coefficient is statistically different from zero because the SE for the slope coefficient is very small (`r formatC(sum1$coefficients["year","Std. Error"],format="f",digits=6)`; `r tbls("coef",display="cite")`) and the overall scale of the measurements is very small.

&nbsp;

`r tbls("coef")`

```{r echo=FALSE, background="white"}
kREG(lm1)
```

`r tbls("ci")`

```{r echo=FALSE, background="white"}
ci1
```

```{r echo=FALSE, par1=TRUE}
fitPlot(lm1,xlab="Year",ylab="Proportion of Males")
```

`r figs("fitplot")`


R Appendix.
```{r eval=FALSE, prompt=FALSE}
d1 <- read.csv("MaleBirths.csv")
lm1 <- lm(propmale~year,data=d1)
summary(lm1)
confint(lm1)
fitPlot(lm1,xlab="Year",ylab="Proportion of Males")
```

----
