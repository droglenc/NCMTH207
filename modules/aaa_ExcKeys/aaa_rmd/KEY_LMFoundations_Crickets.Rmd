---
title: "Exercise Key"
subtitle: "Linear Models Foundation"
author: Derek H. Ogle
layout: page
css: "/css/modules.css"
output:
  html_document:
    fig_height: 3.5
    fig_width: 3.5
    self_contained: false
---

```{r echo=FALSE, eval=FALSE, warning=FALSE}
## Renders an appropriate HTML file and moves to CE directory
source("modules/aaa_ExcKeys/aaa_rmd/zzz_modHTML_CEKeys.R")
modHTML_CEKeys("KEY_LMFoundations_Crickets")
```

```{r echo=FALSE, results='hide', message=FALSE, warning=FALSE}
library(NCStats)
source("../../../rhelpers/knitr_setup.R")

d <- read.csv("https://raw.githubusercontent.com/droglenc/NCData/master/Crickets.csv")
crick.t <- t.test(explore~group,data=d,var.equal=TRUE)
lm1 <- lm(explore~group,data=d)
a1 <- anova(lm1)
s1 <- summary(lm1)
c1 <- coef(lm1)

library(captioner)
tbls <- captioner(prefix="Table")
figs <- captioner(prefix="Figure")
tbls(name="2t","Results from 2-sample t-test of exploration index by dominant or subordinate cricket.")
tbls(name="aov","Analysis of variance table for exploration index by dominant or subordinate cricket")
tbls(name="coef","Coefficient results from the one-way ANOVA for exploration index by dominant or subordinate cricket.")
```

----

<div class="alert alert-warning">
<strong>Note:</strong> 
<ul>
<li>Tables (and figures) should be labeled as described in the <a href="../../../resources/hwformat">homework format description</a>. Table labels go ABOVE the table and figure labels go BELOW the table. Tables (and figures) should be referred to in your answers. See the key below for a model of this.</li>
  <li>Use complete sentences to answer questions.</li>
  <li>Use an R appendix to show the code you used to produce results. Do not include R code in any of your other answers.</li>
  <li>Keep "many" decimals in intermediate calculations ... i.e., don't round until the final answer.</li>
  <li>Note explanations in the key below.</li>
</ul>
</div>

----

## pH in Two Rivers

1. The p-values for the two-sample t-test (`r kPvalue(crick.t$p.value,digits=7)`; `r tbls("2t",display="cite")`), from the ANOVA table (`r kPvalue(a1[1,"Pr(>F)"],digits=7)`; `r tbls("aov",display="cite")`), and for the slope coefficient (`r kPvalue(s1$coefficients[2,"Pr(>|t|)"],digits=7)`; `r tbls("coef",display="cite")`) are all the same. These p-values are all equivalent because the 2-sample t-test hypothesis of equal means (or difference in means equals zero) is the same as the hypothesis for the slope (see below about the slope representing the difference in means) which is the same as the hypothesis for the ANOVA table (i.e., simple model of one mean representing both groups).
1. With these p-values, very strong evidence to reject the null hypothesis exists. Thus, the mean pH appears to differ between the two rivers.
1. The mean of the first (A) group in the 2-sample t-test (`r formatC(crick.t$estimate[1],format="f",digits=3)`; `r tbls("2t",display="cite")`) is the same as the intercept coefficient from the linear model (`r formatC(c1[1],format="f",digits=3)`; `r tbls("coef",display="cite")`). This occurs because an intercept is defined as the "value of $Y$ when $X$=0, on average". In this case, $Y$ is pH and $X$ is "dominant" crickets because dominant is coded with a zero in `lm()` (because the levels are code alphabetically). Thus, the intercept is the mean exploration ($Y$) for dominant crickets ($X=0$).
1. The difference in the means (i.e., `r formatC(crick.t$estimate[2],format="f",digits=3)`-`r formatC(crick.t$estimate[1],format="f",digits=3)` = `r formatC(crick.t$estimate[2]-crick.t$estimate[1],format="f",digits=3)`; `r tbls("2t",display="cite")`) is the same as the slope coefficient in the linear model (i.e., `r formatC(c1[2],format="f",digits=3)`; `r tbls("coef",display="cite")`). This is because the slope coefficient shows the change in $Y$ for a one unit change in $X$. As noted above dominant crickets is coded with a 0 in `lm()` as it is alphabetically first in the group names. Subordinate crickets is thus coded as a 1 in `lm()` as it is alphabetically second. Thus a one unit change in $X$ is simply a move from dominant to subordinate crickets (i.e., from 0 to 1). Thus, the slope is the difference in mean exploration between the dominant and subordinate crickets (i.e., change in $Y$).
1. The df from the two-sample t-test (`r crick.t$parameter`; `r tbls("2t",display="cite")`) and the within-group df from the ANOVA table (`r a1$Df[2]`; `r tbls("aov",display="cite")`) are identical. The within-group df are equal to the total number of individuals ($n=n_{1}+n_{2}$) minus the number of groups ($I=2$), which is the same as for the 2-sample t-test (i.e., $n_{1}+n_{2}-2$).
1. The F test statistic (`r formatC(a1$F[1],format="f",digits=3)`;`r tbls("aov",display="cite")`) is equal to the square of the t test statistic (`r formatC(crick.t$statistic,format="f",digits=3)`$^2$=`r formatC(crick.t$statistic^2,format="f",digits=3)`; `r tbls("2t",display="cite")`). This relationship occurs when the numerator df for the ANOVA is equal to one (i.e., there are only two groups).
1. The SE for the difference in means is equal to $\frac{\bar{x_{1}}-\bar{x_{2}}}{t}$ = $\frac{2.3944-1.3042}{4.8847}$ = 0.2232. The pooled variance ($s_{p}^{2}$) is then equal to this value squared and divided by the sum of the reciprocals of the sample sizes -- i.e., $\frac{0.2232^{2}}{\frac{1}{41}+\frac{1}{39}}$ = 0.9957.
1. The $s_{p}^{2}$ computed in the previous question is the same (within rounding) as $MS_{within}$ (`r tbls("aov",display="cite")`).

`r tbls("2t")`

```{r echo=FALSE, background="white"}
kHtest(crick.t)
```

`r tbls("aov")`

```{r echo=FALSE, background="white"}
kANOVA(lm1)
```

`r tbls("coef")`

```{r echo=FALSE, background="white"}
kREG(lm1)
```

R Appendix.
```{r eval=FALSE, prompt=FALSE}
d <- read.csv("Crickets.csv")
t.test(t.test(explore~group,data=d,var.equal=TRUE)
lm1 <- lm(explore~group,data=d)
anova(lm1)
summary(lm1)
coef(lm1)
```

----
