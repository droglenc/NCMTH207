---
title: "Exercise Key"
subtitle: "One-Way ANOVA"
author: Derek H. Ogle
layout: page
css: "/css/modules.css"
output:
  html_document:
    fig_height: 3.5
    fig_width: 3.5
    self_contained: false
---

```{r echo=FALSE, eval=FALSE, warning=FALSE}
## Renders an appropriate HTML file and moves to CE directory
source("modules/aaa_ExcKeys/aaa_rmd/zzz_modHTML_CEKeys.R")
modHTML_CEKeys("KEY_Anova-1way_Turtles2")
```

```{r echo=FALSE, results='hide', message=FALSE, warning=FALSE}
library(NCStats)
library(multcomp)
source("../../../rhelpers/knitr_setup.R")

d <- read.csv("c:/aaaWork/Web/GitHub/NCMTH207/modules/aaa_ExcKeys/aaa_rmd/turtles.csv")
d$Temperature <- factor(d$Temperature)
lm1 <- lm(Days~Temperature,data=d)
aov1 <- anova(lm1)
mc1 <- glht(lm1,mcp(Temperature="Tukey"))
mc1p <- kGLHT(mc1)
mc1c <- kGLHT(mc1,type="confidence")

library(captioner)
tbls <- captioner(prefix="Table")
figs <- captioner(prefix="Figure")
tbls(name="aov","Analysis of variance table for the days to hatch by temperature group.")
tbls(name="mcp","Tukey's multiple comparison results for the days to hatch by sea turles at various temperature groups.")
tbls(name="mcpci","Tukey's confidence interval results for the difference in mean days to hatch by sea turtles for each pair of temperature groups.")
figs(name="fitplot","Plot of mean (with 95\\% CI) days to hatch by sea turtles at various temperature groups. Different letters indicate means that are significantly different.")
```

----

<div class="alert alert-warning">
<strong>Note:</strong> 
<ul>
  <li>On the first question, you must use the p-value from the ANOVA table. That is the p-value that assesses whether all group means are equal or not. Tukey's multiple comparisons are only used to assess difference in paired means <b>AFTER</b> it has been determined that there is a difference in means. The linear models coefficients table is not appropriate for answering that question either as it does not assess all pairs of means (you should get out of the habit of using `summary()` on your `lm()` results).</li>
  <li>The second question should include a plot of means with appropriate significance letters. Note that when using Tukey's method that there should be letters on each point. With Dunnett's method it may be appropriate to leave one point without a letter, but this should be explained in the figure label.</li>
  <li>In the second to last questions, make sure to clearly indicate which group is greater (or lesser). Don't just say that you are 95% confident that the difference is between such-and-such.</li>
  <li>I round my p-values to four decimal places. As such, if the fifth decimal place is less than 5, then the p-value would round to "0.0000", which does not make much sense. Thus, if the fifth decimal place is less than 5 then I will report my p-values as "<0.00005." You will see examples of this in the answers below.</li>
  <li>Note how concise the answer key is. Please work to get your answers this concise.</li>
</ul>
</div>

----

## Temperature and Turtle Hatchlings II

1. The mean days to hatch is significantly different among the four temperature groups (`r kPvalue(aov1[1,"Pr(>F)"],latex=FALSE)`; `r tbls("aov",display="cite")`).
1. It appears that the mean days to hatch for the 30<sup>o</sup>C group is significantly lower than the mean days to hatch for 15<sup>o</sup>C (`r kPvalue(mc1p[3,"p value"],latex=FALSE)`), 20<sup>o</sup>C (`r kPvalue(mc1p[5,"p value"],latex=FALSE)`), and 25<sup>o</sup>C (`r kPvalue(mc1p[6,"p value"],latex=FALSE)`) groups (`r tbls("mcp",display="cite")`). The mean days to hatch for all other pairs of temperature groups are not significantly different (`r tbls("mcp",display="cite")`). These results are shown visually in `r figs("fitplot",display="cite")`.
1. The mean days to hatch for sea turtles at 30<sup>o</sup>C is between `r formatC(-1*mc1c["30 - 15","upr"],format="f",digits=1)` and `r formatC(-1*mc1c["30 - 15","lwr"],format="f",digits=1)` days lower than that at 15<sup>o</sup>C, between `r formatC(-1*mc1c["30 - 20","upr"],format="f",digits=1)` and `r formatC(-1*mc1c["30 - 20","lwr"],format="f",digits=1)` days lower than that at 20<sup>o</sup>C, and between `r formatC(-1*mc1c["30 - 25","upr"],format="f",digits=1)` and `r formatC(-1*mc1c["30 - 25","lwr"],format="f",digits=1)` days lower than that at 25<sup>o</sup>C (`r tbls("mcpci",display="cite")`).
1. It appears that mean days to hatch is longer at 15, 20, and 25<sup>o</sup>C than at 30<sup>o</sup>C. Thus, it appears that the days to hatch will not decrease substantially until temperatures rise above somewhere between 25 and 30<sup>o</sup>C.

`r tbls("aov")`

```{r echo=FALSE, background="white"}
kANOVA(lm1)
```

`r tbls("mcp")`

```{r echo=FALSE, background="white"}
mc1p
```

```{r echo=FALSE, par1=TRUE}
fitPlot(lm1,xlab="Temperature (C)",ylab="Days to Hatch")
addSigLetters(lm1,cld(mc1),pos=c(2,2,4,4))
```

`r figs("fitplot")`

`r tbls("mcpci")`

```{r echo=FALSE, background="white"}
mc1c
```


R Appendix.
```{r eval=FALSE, prompt=FALSE}
library(multcomp)
d <- read.csv("turtles.csv")
d$Temperature <- factor(d$Temperature)
lm1 <- lm(Days~Temperature,data=d)
anova(lm1)
mc1 <- glht(lm1,mcp(Temperature="Tukey"))
summary(mc1)
confint(mc1)
fitPlot(lm1,xlab="Temperature (C)",ylab="Days to Hatch")
addSigLetters(lm1,c("b","b","b","a"),pos=c(2,2,4,4))
```

----
