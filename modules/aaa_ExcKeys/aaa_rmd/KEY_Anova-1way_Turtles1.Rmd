---
title: "Exercise Key"
subtitle: "Linear Models Foundation"
author: Derek H. Ogle
layout: page
css: "/css/modules.css"
output:
  html_document:
    fig_height: 3.5
    fig_width: 3.5
    self_contained: false
---

```{r echo=FALSE, eval=FALSE, warning=FALSE}
## Renders an appropriate HTML file and moves to CE directory
source("modules/aaa_ExcKeys/aaa_rmd/zzz_modHTML_CEKeys.R")
modHTML_CEKeys("KEY_Anova-1way_Turtles1")
```

```{r echo=FALSE, results='hide', message=FALSE, warning=FALSE}
library(NCStats)
source("../../../rhelpers/knitr_setup.R")

d <- read.csv("c:/aaaWork/Web/GitHub/NCMTH207/modules/aaa_ExcKeys/aaa_rmd/turtles.csv")
d$Temperature <- factor(d$Temperature)
lm1 <- lm(Days~Temperature,data=d)
lev1 <- levenesTest(lm1)
ad1 <- adTest(lm1$residuals)
out1 <- outlierTest(lm1)

library(captioner)
tbls <- captioner(prefix="Table")
figs <- captioner(prefix="Figure")
figs(name="residplot","Histogram of residuals (left) and boxplot of residuals by treatment group (right) for the turtle study.")
```

----

<div class="alert alert-warning">
<strong>Note:</strong> 
<ul>
  <li>For the independence assumption, be clear that you have thought through what it means to be independent within or among groups. It is not adequate to just say "the groups are independent." Also note that there is nothing in the data that speaks to independence. Assessing independence is purely a thought process.</li>
  <li>Note how concise the answer key is. Please work to get your answers this concise.</li>
</ul>
</div>

----

## Temperature and Turtle Hatchlings I

1. The individuals appear to be independent both within and among groups as each egg was put into its own container and randomly given a temperature such that the results for any one egg would not impact the results of any other egg given the same (within) or different (among) temperature.
1. The Levene's test suggests that the variances are equal among the temperature groups (`r kPvalue(lev1[1,"Pr(>F)"],latex=FALSE)`). The boxplots of residuals are not approximately equal in height (`r figs("residplot",display="cite")`-Right). Levene's test though is definitive and, thus, the variances are approximately equal.
1. The Anderson-Darling normality test suggests that the residuals are normally distributed (`r kPvalue(ad1$p.value,latex=FALSE)`). The histogram of the residuals is slightly (but not strongly) left-skewed (`r figs("residplot",display="cite")`-Left). The Anderson-Darling test though is definitive and, thus, the residuals appear to be normal.
1. There are no significant outliers (`r kPvalue(out1$bonf.p,latex=FALSE)`), though the residual plot suggests possible outliers in the 25<sup>o</sup>C and 30<sup>o</sup>C groups (`r figs("residplot",display="cite")`).

```{r echo=FALSE, fig.width=7, fig.height=3.5, par1=TRUE}
NCStats:::iAssumPlot_ANOVA(NCStats:::iTypeoflm(lm1),
                           lambda=1,shifty=0,show.stats=TRUE,boxplot=TRUE,
                           alpha=0.05,col.hist="gray70")
```

`r figs("residplot")`

R Appendix.
```{r eval=FALSE, prompt=FALSE}
d <- read.csv("turtles.csv")
d$Temperature <- factor(d$Temperature)
lm1 <- lm(Days~Temperature,data=d)
transChooser(lm1)
```

----
