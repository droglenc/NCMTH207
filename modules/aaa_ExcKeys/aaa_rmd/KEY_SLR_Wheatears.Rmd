---
title: "Exercise Key"
subtitle: "Simple Linear Regression"
author: Derek H. Ogle
layout: page
css: "/css/modules.css"
output:
  html_document:
    fig_height: 3.5
    fig_width: 3.5
    self_contained: false
---

```{r echo=FALSE, eval=FALSE, warning=FALSE}
## Renders an appropriate HTML file and moves to CE directory
source("modules/aaa_ExcKeys/aaa_rmd/zzz_modHTML_CEKeys.R")
modHTML_CEKeys("KEY_SLR_Wheatears")
```

```{r echo=FALSE, results='hide', message=FALSE, warning=FALSE}
library(NCStats)
source("../../../rhelpers/knitr_setup.R")

d3 <- data.frame(msm=c(3.33,4.62,5.43,5.73,6.12,6.29,6.45,
                       6.51,6.65,6.75,6.81,7.56,7.83,8.02,
                       8.06,8.18,9.08,9.15,9.35,9.42,9.95),
                 tcr=c(0.252,0.263,0.251,0.251,0.183,0.213,0.332,
                       0.203,0.252,0.342,0.471,0.431,0.312,0.304,
                       0.370,0.381,0.430,0.430,0.213,0.508,0.411))
lm3 <- lm(tcr~msm,data=d3)
sum3 <- summary(lm3)
ci3 <- confint(lm3)
pred1 <- predict(lm3,data.frame(msm=5),interval="confidence")
pred2 <- predict(lm3,data.frame(msm=5),interval="prediction")

library(captioner)
tbls <- captioner(prefix="Table")
figs <- captioner(prefix="Figure")
tbls(name="coef","Summary of the linear regression of T-cell response on mean stone mass carried by Black Wheaters.")
tbls(name="ci","Confidence intervals for coefficients of the linear regression of T-cell response on mean stone mass carried by Black Wheaters.")
figs(name="fitplot","Scatterplot of T-cell response and mean stone mass carried by Black Wheaters with the best-fit line.")
```

----

<div class="alert alert-warning">
<strong>Note:</strong> 
<ul>
  <li>When discussing whether there is a relationship between the response and the explanatory variable you must explicitly note that you are referring to the slope p-value. You cannot just refer the reader to the "p-value" in the table from `summary()` because there are three p-values in that table. Be precise with your language!!</li>
  <li>Remember to use CI when describing rates of change (i.e., slopes) or predictions; don't just use the best estimate.</li>
</ul>
</div>

----

## Health of Black Wheatears

1. Yes, there is a signficant relationship between T-cell response and mean stone mass carried by Black Wheatears (`r kPvalue(sum3$coefficients["msm","Pr(>|t|)"],digits=4,latex=FALSE)`; `r tbls("coef",display="cite")`). Specifically, as the mean stone mass increases by 1 g the mean T-cell response increased between `r formatC(ci3["msm",1],format="f",digits=3)` and `r formatC(ci3["msm",2],format="f",digits=3)` `r tbls("ci",display="cite")`.

1. The T-cell response for all Black Wheaters that carried a mean stone mass of 5 g is between `r formatC(pred2[1,"lwr"],format="f",digits=3)` and `r formatC(pred2[1,"upr"],format="f",digits=3)`.

1. The mean T-cell response for all Black Wheaters that carried a mean stone mass of 5 g is between `r formatC(pred1[1,"lwr"],format="f",digits=3)` and `r formatC(pred1[1,"upr"],format="f",digits=3)`.

1. The prediction interval for the individual (question 3) is wider than the confidence interval for the mean (question 2) because there is more variability in predicting an individual as compared to a mean. Variability for predicting an individual includes both sampling and natural variability, whereas variability for the mean includes only sampling variability.

1. The relationship between T-cell respose and mean stone mass carried by a Black Wheater is illustrated in `r figs("fitplot",display="cite")`.

&nbsp;

`r tbls("coef")`

```{r echo=FALSE, background="white"}
kREG(lm3)
```

`r tbls("ci")`

```{r echo=FALSE, background="white"}
ci3
```

```{r echo=FALSE, par1=TRUE}
fitPlot(lm3,xlab="Mean Stone Mass Carried (g)",ylab="T-cell Response")
```

`r figs("fitplot")`


R Appendix.
```{r eval=FALSE, prompt=FALSE}
d3 <- read.csv("Wheatears.csv")
lm3 <- lm(tcr~msm,data=d3)
summary(lm3)
confint(lm3)
predict(lm3,data.frame(tcr=5),interval="prediction")
predict(lm3,data.frame(tcr=5),interval="confidence")
fitPlot(lm3,xlab="Mean Stone Mass Carried (g)",ylab="T-cell Response")
```

----
