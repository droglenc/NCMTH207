---
title: "Exercise Key"
subtitle: "Linear Models Foundation"
author: Derek H. Ogle
layout: page
css: "/css/modules.css"
output:
  html_document:
    fig_height: 3.5
    fig_width: 3.5
    self_contained: false
---

```{r echo=FALSE, eval=FALSE, warning=FALSE}
## Renders an appropriate HTML file and moves to CE directory
source("modules/aaa_ExcKeys/aaa_rmd/zzz_modHTML_CEKeys.R")
modHTML_CEKeys("KEY_LMFoundations_pHinRivers")
```

```{r echo=FALSE, results='hide', message=FALSE, warning=FALSE}
library(NCStats)
source("../../../rhelpers/knitr_setup.R")

d <- data.frame(pH=c(8.97,9.12,9.41,8.67,9.94,8.28,7.86,7.51,9.18,7.68,
                     6.67,5.83,6.84,6.86,5.89,7.42,6.56,5.99,5.33,6.69),
                river=factor(rep(c("A","B"),each=10)))
rvr.t <- t.test(pH~river,data=d,var.equal=TRUE)
lm1 <- lm(pH~river,data=d)
a1 <- anova(lm1)
s1 <- summary(lm1)
c1 <- coef(lm1)

library(captioner)
tbls <- captioner(prefix="Table")
figs <- captioner(prefix="Figure")
tbls(name="2t","Results from 2-sample t-test of pH by stream.")
tbls(name="aov","Analysis of variance table for pH by stream.")
tbls(name="coef","Coefficient results from the one-way ANOVA for pH by stream.")
```

----

<div class="alert alert-warning">
<strong>Note:</strong> 
<ul>
<li>Tables (and figures) should be labeled as described in the \href{http://derekogle.com/NCMTH207/resources/hwformat}{homework format description}. Table labels go ABOVE the table and figure labels go BELOW the table. Tables (and figures) should be referred to in your answers. See the key below for a model of this.</li>
  <li>Use complete sentences to answer questions.</li>
  <li>Use an R appendix to show the code you used to produce results. Do not include R code in any of your other answers.</li>
  <li>Keep "many" decimals in intermediate calculations ... i.e., don't round until the final answer.</li>
  <li>Note explanations in the key below.</li>
</ul>
</div>

----

## pH in Two Rivers

1. The p-values for the two-sample t-test (`r kPvalue(rvr.t$p.value,digits=7)`; `r tbls("2t",display="cite")`), from the ANOVA table (`r kPvalue(a1[1,"Pr(>F)"],digits=7)`; `r tbls("aov",display="cite")`), and for the slope coefficient (`r kPvalue(s1$coefficients[2,"Pr(>|t|)"],digits=7)`; `r tbls("coef",display="cite")`) are all the same. These p-values are all equivalent because the 2-sample t-test hypothesis of equal means (or difference in means equals zero) is the same as the hypothesis for the slope (see below about the slope representing the difference in means) which is the same as the hypothesis for the ANOVA table (i.e., simple model of one mean representing both groups).
1. With these p-values, very strong evidence to reject the null hypothesis exists. Thus, the mean pH appears to differ between the two rivers.
1. The mean of the first (A) group in the 2-sample t-test (`r formatC(rvr.t$estimate[1],format="f",digits=3)`; `r tbls("2t",display="cite")`) is the same as the intercept coefficient from the linear model (`r formatC(c1[1],format="f",digits=3)`; `r tbls("coef",display="cite")`). This occurs because an intercept is defined as the "value of $Y$ when $X$=0, on average". In this case, $Y$ is pH and $X$ is "stream A" because stream A is coded with a zero in `lm()` (because the levels are code alphabetically). Thus, the intercept is the mean pH ($Y$) for stream A ($X=0$).
1. The difference in the means (i.e., `r formatC(rvr.t$estimate[2],format="f",digits=3)`-`r formatC(rvr.t$estimate[1],format="f",digits=3)` = `r formatC(rvr.t$estimate[2]-rvr.t$estimate[1],format="f",digits=3)`; `r tbls("2t",display="cite")`) is the same as the slope coefficient in the linear model (i.e., `r formatC(c1[2],format="f",digits=3)`; `r tbls("coef",display="cite")`). This is because the slope coefficient shows the change in $Y$ for a one unit change in $X$. As noted above stream A is coded with a 0 in `lm()` as it is alphabetically first in the stream names. Stream B is thus coded as a ` in `lm()` as it is alphabetically second. Thus a one unit change in $X$ is simply a move from stream A to stream B (i.e., from 0 to 1). Thus, the slope is the difference in mean pH between the two streams (i.e., change in $Y$).
1. The df from the two-sample t-test (`r rvr.t$parameter`; `r tbls("2t",display="cite")`) and the within-group df from the ANOVA table (`r a1$Df[2]`; `r tbls("aov",display="cite")`) are identical. The within-group df are equal to the total number of individuals ($n=n_{1}+n_{2}$) minus the number of groups ($I=2$), which is the same as for the 2-sample t-test (i.e., $n_{1}+n_{2}-2$).
1. The F test statistic (`r formatC(a1$F[1],format="f",digits=3)`;`r tbls("aov",display="cite")`) is equal to the square of the t test statistic (`r formatC(rvr.t$statistic,format="f",digits=3)`$^2$=`r formatC(rvr.t$statistic^2,format="f",digits=3)`; `r tbls("2t",display="cite")`). This relationship occurs when the numerator df for the ANOVA is equal to one (i.e., there are only two groups).
1. The SE for the difference in means is equal to $\frac{{\bar x_1  - \bar x_2 }}{t}$ = $\frac{8.662-6.408}{6.9849}$ = 0.3227. The pooled variance is then equal to this value squared ($0.3227^{2}$ = 0.1041) and divided by the sum of the reciprocals of the sample sizes ($\frac{1}{10}+\frac{1}{10}$ = 0.2) = 0.5207.
1. The pooled variance computed in the previous question is the same as $MS_{within}$ (`r tbls("aov",display="cite")`).

`r tbls("2t")`

```{r echo=FALSE, background="white"}
kHtest(rvr.t)
```

`r tbls("aov")`

```{r echo=FALSE, background="white"}
kANOVA(lm1)
```

`r tbls("coef")`

```{r echo=FALSE, background="white"}
kREG(lm1)
```

R Appendix.
```{r eval=FALSE, prompt=FALSE}
d <- read.csv("RiverPh.csv")
t.test(pH~river,data=d,var.equal=TRUE)
lm1 <- lm(pH~river,data=d)
anova(lm1)
summary(lm1)
coef(lm1)
```

----
