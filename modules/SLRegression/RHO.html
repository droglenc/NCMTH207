---
layout: page
title: "Simple Linear Regression"
subtitle: R Handout
author: "Derek H. Ogle"
css: "/css/modules.css"
---


<hr />
<div id="initialization" class="section level2">
<h2>Initialization</h2>
<pre class="r"><code>&gt; library(NCStats)</code></pre>
<hr />
</div>
<div id="salmon-sperm-example" class="section level1">
<h1>Salmon Sperm Example</h1>
<div id="background" class="section level2">
<h2>Background</h2>
<p><a href="http://www.biolreprod.org/content/66/1/98.long">Vladic <em>et al.</em> (2002)</a> recorded (in <code>SalmonSperm.csv</code>) the probability of successful egg fertilization (<code>fert.success</code>) and the length of sperm tail end piece (<code>step.len</code>). They asked “Are fertilization success and length of sperm related?”</p>
<pre class="r"><code>&gt; setwd(&quot;C:/aaaWork/Web/GitHub/NCMTH207/modules/SLRegression&quot;)
&gt; ss &lt;- read.csv(&quot;SalmonSperm.csv&quot;)
&gt; ss &lt;- ss[-c(1,10,11),]  # only for class demo purposes
&gt; str(ss)</code></pre>
<pre><code>&#39;data.frame&#39;:   11 obs. of  3 variables:
 $ step.len : num  2.94 3 3.02 3.17 3.18 3.2 3.27 3.31 3.72 3.84 ...
 $ fert.succ: num  3 2.2 7 7 13.5 10.4 6.7 12.8 37.8 30 ...
 $ mat      : Factor w/ 2 levels &quot;Adult&quot;,&quot;Parr&quot;: 2 2 1 2 1 1 1 1 2 2 ...</code></pre>
<pre class="r"><code>&gt; xlbl &lt;- &quot;Sperm Tail End Piece Length (um)&quot;
&gt; ylbl &lt;- &quot;Fertilization Success&quot;</code></pre>
</div>
<div id="lecture-support-i-model-fitting-and-simple-predictions" class="section level2">
<h2>Lecture Support I – Model Fitting and Simple Predictions</h2>
<pre class="r"><code>&gt; ( lm1 &lt;- lm(fert.succ~step.len,data=ss) )</code></pre>
<pre><code>Coefficients:
(Intercept)     step.len  
    -100.21        34.61  </code></pre>
<pre class="r"><code>&gt; fitPlot(lm1,xlab=xlbl,ylab=ylbl,main=&quot;&quot;)</code></pre>
<p><img src="RHO_files/figure-html/unnamed-chunk-5-1.png" title="" alt="" width="288" /></p>
<pre class="r"><code>&gt; predict(lm1,data.frame(step.len=3.5))</code></pre>
<pre><code>       1 
20.92912 </code></pre>
</div>
<div id="lecture-support-ii-sampling-variability" class="section level2">
<h2>Lecture Support II – Sampling Variability</h2>
<pre class="r"><code>&gt; summary(lm1)</code></pre>
<pre><code>Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)
(Intercept) -100.205     13.015  -7.699 3.00e-05
step.len      34.610      3.889   8.901 9.35e-06

Residual standard error: 4.366 on 9 degrees of freedom
Multiple R-squared: 0.898,  Adjusted R-squared: 0.8866 
F-statistic: 79.22 on 1 and 9 DF,  p-value: 9.35e-06 </code></pre>
<pre class="r"><code>&gt; confint(lm1)</code></pre>
<pre><code>                 2.5 %    97.5 %
(Intercept) -129.64815 -70.76202
step.len      25.81336  43.40619</code></pre>
<pre class="r"><code>&gt; fitPlot(lm1,interval=&quot;both&quot;,xlab=xlbl,ylab=ylbl,main=&quot;&quot;)</code></pre>
<p><img src="RHO_files/figure-html/unnamed-chunk-6-1.png" title="" alt="" width="288" /></p>
<pre class="r"><code>&gt; predict(lm1,data.frame(step.len=3.5),interval=&quot;confidence&quot;)</code></pre>
<pre><code>       fit     lwr      upr
1 20.92912 17.5967 24.26153</code></pre>
<pre class="r"><code>&gt; predict(lm1,data.frame(step.len=3.5),interval=&quot;prediction&quot;)</code></pre>
<pre><code>       fit      lwr      upr
1 20.92912 10.50502 31.35321</code></pre>
<pre class="r"><code>&gt; predictionPlot(lm1,data.frame(step.len=c(3.3,3.5)),interval=&quot;prediction&quot;,
                 xlab=xlbl,ylab=ylbl,main=&quot;&quot;)</code></pre>
<p><img src="RHO_files/figure-html/unnamed-chunk-7-1.png" title="" alt="" width="288" /></p>
<pre><code>  obs step.len      fit       lwr      upr
1   1      3.3 14.00716  3.687506 24.32682
2   2      3.5 20.92912 10.505016 31.35321</code></pre>
</div>
<div id="lecture-support-iii-model-comparisons" class="section level2">
<h2>Lecture Support III – Model Comparisons</h2>
<pre class="r"><code>&gt; anova(lm1)</code></pre>
<pre><code>Analysis of Variance Table

Response: fert.succ
          Df  Sum Sq Mean Sq F value   Pr(&gt;F)
step.len   1 1510.23 1510.23  79.219 9.35e-06
Residuals  9  171.58   19.06                 </code></pre>
</div>
<div id="lecture-support-iv-assumption-checking" class="section level2">
<h2>Lecture Support IV – Assumption Checking</h2>
<pre class="r"><code>&gt; residPlot(lm1,main=&quot;&quot;)</code></pre>
<p><img src="RHO_files/figure-html/unnamed-chunk-9-1.png" title="" alt="" width="576" /></p>
<pre class="r"><code>&gt; adTest(lm1$residuals)</code></pre>
<pre><code>Anderson-Darling normality test with x 
A = 0.4022, p-value = 0.2962</code></pre>
<pre class="r"><code>&gt; outlierTest(lm1)</code></pre>
<pre><code>
No Studentized residuals with Bonferonni p &lt; 0.05
Largest |rstudent|:
   rstudent unadjusted p-value Bonferonni p
12 3.717896          0.0058892     0.064781</code></pre>
</div>
</div>
<div id="petrels-example" class="section level1">
<h1>Petrels Example</h1>
<div id="background-1" class="section level2">
<h2>Background</h2>
<p><a href="http://www.jstor.org/stable/4318?seq=1#page_scan_tab_contents">Croxall (1982)</a> examined the weight loss of adult petrels during periods of egg incubation. He examined 13 species but some had measurements for both sexes such that 19 measurements are found in <code>Petrels.csv</code>. For each measurement the mean initial weight (g) and mean weight lost (g/g/d) were recorded. Determine if the mean initial weight significant explains variability in mean weight lost.</p>
<pre class="r"><code>&gt; petrels &lt;- read.csv(&quot;Petrels.csv&quot;)
&gt; str(petrels)</code></pre>
<pre><code>&#39;data.frame&#39;:   19 obs. of  4 variables:
 $ species    : Factor w/ 13 levels &quot;Diomedea chrysostoma&quot;,..: 2 2 4 4 1 1 3 3 3 9 ...
 $ sex        : Factor w/ 4 levels &quot;both&quot;,&quot;female&quot;,..: 3 2 3 2 3 2 3 2 1 3 ...
 $ weight     : int  10577 9022 3922 3694 3751 3624 3305 3000 2996 668 ...
 $ weight.loss: num  0.0087 0.0096 0.013 0.011 0.01 0.012 0.011 0.0125 0.0109 0.0128 ...</code></pre>
</div>
<div id="analysis" class="section level2">
<h2>Analysis</h2>
<pre class="r"><code>&gt; lm1 &lt;- lm(weight.loss~weight,data=petrels)
&gt; fitPlot(lm1,xlab=&quot;Weight (g)&quot;,ylab=&quot;Weight Loss (g/g/d)&quot;,main=&quot;&quot;)</code></pre>
<p><img src="RHO_files/figure-html/unnamed-chunk-11-1.png" title="" alt="" width="288" /></p>
<pre class="r"><code>&gt; residPlot(lm1,main=&quot;&quot;)</code></pre>
<p><img src="RHO_files/figure-html/unnamed-chunk-12-1.png" title="" alt="" width="576" /></p>
<pre class="r"><code>&gt; with(petrels,max(weight)/min(weight))</code></pre>
<pre><code>[1] 251.8333</code></pre>
<pre class="r"><code>&gt; ## transChooser(lm1) # interactive, results not shown
&gt; petrels$log.wt &lt;- log(petrels$weight)
&gt; petrels$log.wtloss &lt;- log(petrels$weight.loss)
&gt; lm2 &lt;- lm(log.wtloss~log.wt,data=petrels)
&gt; fitPlot(lm2,xlab=&quot;log Weight (g)&quot;,ylab=&quot;log Weight Loss (g/g/d)&quot;,main=&quot;&quot;)</code></pre>
<p><img src="RHO_files/figure-html/unnamed-chunk-13-1.png" title="" alt="" width="288" /></p>
<pre class="r"><code>&gt; residPlot(lm2,main=&quot;&quot;)</code></pre>
<p><img src="RHO_files/figure-html/unnamed-chunk-14-1.png" title="" alt="" width="576" /></p>
<pre class="r"><code>&gt; adTest(lm2$residuals)</code></pre>
<pre><code>Anderson-Darling normality test with x 
A = 0.3881, p-value = 0.3514</code></pre>
<pre class="r"><code>&gt; anova(lm2)</code></pre>
<pre><code>Analysis of Variance Table

Response: log.wtloss
          Df Sum Sq Mean Sq F value    Pr(&gt;F)
log.wt     1 6.5113  6.5113  140.65 1.204e-09
Residuals 17 0.7870  0.0463                  </code></pre>
<pre class="r"><code>&gt; summary(lm2)</code></pre>
<pre><code>Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)
(Intercept) -1.73403    0.19792  -8.761 1.04e-07
log.wt      -0.33632    0.02836 -11.860 1.20e-09

Residual standard error: 0.2152 on 17 degrees of freedom
Multiple R-squared: 0.8922, Adjusted R-squared: 0.8858 
F-statistic: 140.6 on 1 and 17 DF,  p-value: 1.204e-09 </code></pre>
<pre class="r"><code>&gt; confint(lm2)</code></pre>
<pre><code>                 2.5 %     97.5 %
(Intercept) -2.1516113 -1.3164546
log.wt      -0.3961507 -0.2764885</code></pre>
<pre class="r"><code>&gt; ( p.log.wtloss &lt;- predict(lm2,data.frame(log.wt=log(5000)),interval=&quot;confidence&quot;) )</code></pre>
<pre><code>        fit       lwr       upr
1 -4.598532 -4.746569 -4.450495</code></pre>
<pre class="r"><code>&gt; exp(p.log.wtloss)*exp(anova(lm2)[2,3]/2)</code></pre>
<pre><code>         fit         lwr        upr
1 0.01030234 0.008884726 0.01194614</code></pre>
</div>
</div>


</div>

<script>

// add bootstrap table styles to pandoc tables
$(document).ready(function () {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
});

</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
