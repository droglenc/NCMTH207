---
layout: page
title: "Linear Model Foundations"
subtitle: R Handout
author: "Derek H. Ogle"
css: "/css/modules.css"
---
</div>


<hr />
<div id="initialization" class="section level2">
<h2>Initialization</h2>
<pre class="r"><code>&gt; library(NCStats)</code></pre>
</div>
<div id="background" class="section level2">
<h2>Background</h2>
<p><a href="http://www.sciencedirect.com/science/article/pii/S0272494499901469">Sholl <em>et al.</em> (2000)</a>{:target=“_blank“} examined the relative sense of direction for female and male subjects. Specifically, 30 male and 30 female subjects were taken to an unfamiliar wooded park and given spatial orientation tests, including being asked to point to the south. The absolute pointing error (in degrees away from due south) was recorded. The results are in <code>SexDirection.csv</code>. Use these results to test, at the 5% level, if males have a better sense of direction than females?</p>
<pre class="r"><code>&gt; setwd(&quot;C:/aaaWork/Web/GitHub/NCMTH207/modules/LMFoundations&quot;)
&gt; sdir &lt;- read.csv(&quot;SexDirection.csv&quot;)
&gt; str(sdir)</code></pre>
<pre><code>&#39;data.frame&#39;:   60 obs. of  2 variables:
 $ abserr: int  13 13 38 59 58 8 130 68 23 5 ...
 $ sex   : Factor w/ 2 levels &quot;female&quot;,&quot;male&quot;: 2 2 2 2 2 2 2 2 2 2 ...</code></pre>
<pre class="r"><code>&gt; sdir$fsex &lt;- factor(sdir$sex,levels=c(&quot;male&quot;,&quot;female&quot;))
&gt; levels(sdir$fsex)</code></pre>
<pre><code>[1] &quot;male&quot;   &quot;female&quot;</code></pre>
<pre class="r"><code>&gt; levels(sdir$sex)</code></pre>
<pre><code>[1] &quot;female&quot; &quot;male&quot;  </code></pre>
</div>
<div id="two-sample-t-test-traditional-method" class="section level2">
<h2>Two-Sample t-Test (Traditional Method)</h2>
<pre class="r"><code>&gt; hist(abserr~fsex,data=sdir,xlab=&quot;Absolute Error&quot;,breaks=seq(0,200,25),col=&quot;gray90&quot;)
&gt; Summarize(abserr~fsex,data=sdir,digits=2)</code></pre>
<pre><code>    fsex  n mean    sd min    Q1 median    Q3 max
1   male 30 37.6 38.49   3 11.50   22.5 58.75 167
2 female 30 55.8 48.26   3 15.75   35.0 88.25 176</code></pre>
<pre class="r"><code>&gt; levenesTest(abserr~fsex,data=sdir)</code></pre>
<p><img src="RHO_files/figure-html/unnamed-chunk-5-1.png" width="576" /></p>
<pre><code>Levene&#39;s Test for Homogeneity of Variance (center = median)
      Df F value Pr(&gt;F)
group  1  2.1692 0.1462
      58               </code></pre>
<pre class="r"><code>&gt; t.test(abserr~fsex,data=sdir,var.equal=TRUE)</code></pre>
<pre><code> Two Sample t-test with abserr by fsex 
t = -1.6149, df = 58, p-value = 0.1118
alternative hypothesis: true difference in means is not equal to 0 
95 percent confidence interval:
 -40.758823   4.358823 
sample estimates:
  mean in group male mean in group female 
                37.6                 55.8 </code></pre>
<pre class="r"><code>&gt; t.test(abserr~sex,data=sdir,var.equal=TRUE)</code></pre>
<pre><code> Two Sample t-test with abserr by sex 
t = 1.6149, df = 58, p-value = 0.1118
alternative hypothesis: true difference in means is not equal to 0 
95 percent confidence interval:
 -4.358823 40.758823 
sample estimates:
mean in group female   mean in group male 
                55.8                 37.6 </code></pre>
</div>
<div id="two-sample-t-test-as-a-linear-model" class="section level2">
<h2>Two-Sample t-Test (As a Linear Model)</h2>
<pre class="r"><code>&gt; lm1 &lt;- lm(abserr~fsex,data=sdir)
&gt; summary(lm1)</code></pre>
<pre><code>Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)   37.600      7.969   4.718 1.54e-05
fsexfemale    18.200     11.270   1.615    0.112

Residual standard error: 43.65 on 58 degrees of freedom
Multiple R-squared: 0.04303,    Adjusted R-squared: 0.02653 
F-statistic: 2.608 on 1 and 58 DF,  p-value: 0.1118 </code></pre>
<pre class="r"><code>&gt; confint(lm1)</code></pre>
<pre><code>                2.5 %   97.5 %
(Intercept) 21.648503 53.55150
fsexfemale  -4.358823 40.75882</code></pre>
<pre class="r"><code>&gt; fitPlot(lm1,xlab=&quot;Sex&quot;,ylab=&quot;Absolute Error&quot;,main=&quot;&quot;)</code></pre>
<p><img src="RHO_files/figure-html/unnamed-chunk-6-1.png" width="288" /></p>
<pre class="r"><code>&gt; anova(lm1)</code></pre>
<pre><code>Analysis of Variance Table

Response: abserr
          Df Sum Sq Mean Sq F value Pr(&gt;F)
fsex       1   4969  4968.6   2.608 0.1118
Residuals 58 110496  1905.1               </code></pre>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
